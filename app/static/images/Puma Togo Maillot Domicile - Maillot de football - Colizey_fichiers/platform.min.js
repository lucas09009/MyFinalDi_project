(function(window,document){"use strict";const queuedEvents=Array.isArray(window.uSizy)?window.uSizy:[];let bodyOverflow,buttonElements,mapIterator;function toCamelCase(string){return string.replace(/-([a-z])/gi,(function(m,letter){return letter.toUpperCase()}))}function intersection(setA,setB){let _intersection=new Set;for(let elem of setB)setA.has(elem)&&_intersection.add(elem);return _intersection}function setEventListener(key,target,type,listener,options){uSizy.globalListener.has(key)||(uSizy.globalListener.add(key),target.addEventListener(type,listener,options))}function domReady(key,fn){setEventListener(key,document,"DOMContentLoaded",fn),"interactive"!==document.readyState&&"complete"!==document.readyState||fn()}function getDataset(element){let counter,length,attribute,match,dataset={},attributes=element.attributes;for(counter=0,length=attributes.length;counter<length;counter+=1)attribute=attributes[counter],match=attribute.name.match(/^data-(.+)/),match&&(dataset[toCamelCase(match[1])]=attribute.value);element.dataset=dataset}function storageAvailable(type){try{let storage=window[type],x="__storage_test__";return storage.setItem(x,x),storage.removeItem(x),!0}catch(e){return!1}}function saveProduct(data){}function loadMap(elements){let map=new Map;for(let i=0;i<elements.length;i++){let elem=elements[i];document.documentElement.dataset||Object.getOwnPropertyDescriptor(Element.prototype,"dataset")&&Object.getOwnPropertyDescriptor(Element.prototype,"dataset").get||getDataset(elem);let product=elem.dataset.product||elem.dataset.uniqueProductId,button_list=[];map.has(product)&&(button_list=map.get(product)),button_list.push(elem),map.set(product,button_list)}return map}function observeVisibility(buttonElement){new IntersectionObserver((function(entries){entries.some((function(entry){return entry.isIntersecting}))&&checkVisibilityChange()})).observe(buttonElement)}function selectVisibleButtons(product,button_list){let visibleButtons=[];for(let i=button_list.length-1;i>=0;i--){let buttonElement=button_list[i];null!==buttonElement.offsetParent?visibleButtons.push(buttonElement):observeVisibility(buttonElement)}visibleButtons.length<=0&&(visibleButtons=[button_list[0]]),visibleButtons.forEach((function(buttonElement){buildButtonElement(buttonElement)}))}function _loadSk(){let sk;return storageAvailable("localStorage")&&(sk=window.localStorage.getItem("usizy.sk")),sk||(sk=document.cookie.replace(/(?:^|.*;\s*)usizy\.sk\s*=\s*([^;]*).*$|^.*$/,"$1")),sk}function buildRequestData(element){element.dataset.btid="usizy-"+Math.random().toString(36).substr(2)+"-"+(new Date).getTime();let orient="";window.matchMedia("(orientation: portrait)").matches&&(orient="p"),window.matchMedia("(orientation: landscape)").matches&&(orient="l");let data={layout:element.dataset.layout||"link",or:orient,sh:Math.min(window.innerHeight||1/0,window.screen.height),sw:window.screen.width||0,btid:element.dataset.btid||""};element.dataset.branding&&(data.branding=element.dataset.branding),element.dataset.country&&(data.country=element.dataset.country),element.dataset.language&&(data.language=element.dataset.language),element.dataset.text&&(data.text=element.dataset.text),element.dataset.color&&(data.color=element.dataset.color),element.dataset.background&&(data.background=element.dataset.background),element.dataset.style&&(data.style=element.dataset.style),element.dataset.iconcolor&&(data.iconcolor=element.dataset.iconcolor),element.dataset.iconstyle&&(data.iconstyle=element.dataset.iconstyle),element.dataset.user&&(data.user=element.dataset.user),element.dataset.email&&(data.email=element.dataset.email),element.dataset.session&&(data.session=element.dataset.session),element.dataset.visitor&&(data.visitor=element.dataset.visitor),element.dataset.order&&(data.order=element.dataset.order),element.dataset.product?data.product=element.dataset.product:element.dataset.uniqueProductId&&(data.product=element.dataset.uniqueProductId),element.dataset.brand&&(data.brand=element.dataset.brand),element.dataset.price&&(data.price=element.dataset.price),element.dataset.guidelink&&(data.guidelink=element.dataset.guidelink),element.dataset.system?data.sizesystem=element.dataset.system:element.dataset.sizesystem&&(data.sizesystem=element.dataset.sizesystem),element.dataset.device&&(data.device=element.dataset.device),element.dataset.img&&(data.img=element.dataset.img),element.dataset.logo&&(data.logo=element.dataset.logo),element.dataset.forid&&(data.forid=element.dataset.forid),element.dataset.client&&(data.client=element.dataset.client),element.dataset.autoClick&&(data.autoclick=1);let sk=_loadSk();if(sk&&"undefined"!==sk&&(data.sk=sk),element.dataset.ref)data.ref=element.dataset.ref;else try{const loc=window.top.location;data.ref=loc.protocol+"//"+loc.hostname+loc.pathname}catch(DOMException){}return data}function webComponentResponse(buttonElement,data){if(data.html&&buttonElement.insertAdjacentHTML("afterend",data.html),data.scripts&&data.scripts.forEach((function(js){const script=document.createElement("script");script.src=js,buttonElement.appendChild(script)})),data.script){const script=document.createElement("script");script.innerHTML=data.script,buttonElement.appendChild(script)}buttonElement.style.display="none";let width=buttonElement.dataset.width;if(width){document.getElementById(buttonElement.dataset.btid).style.width=width.indexOf("%")>-1?width:width+"px"}}function buildWebComponent(buttonElement){let data=buildRequestData(buttonElement);data.channel="web-btn",fetch(window.uSizy.URL+"/api/v1/display-button",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(data)}).then((function(response){response.ok&&response.json().then((function(data){webComponentResponse(buttonElement,data)}))}))}function apiCallResponse(r){_saveSk(r.sk),"show_product_app"===r.show?window.uSizy.associated_product():"show_auto_app"===r.show?(window.uSizy.associated_product(),window.postMessage({subject:"EVENT_RECOMMENDATION"},"*"),r.subject="AUTOSHOW",window.postMessage(r,"*")):"show_empty"===r.show&&window.uSizy.unassociated_product()}function buildApiCall(apiElement){let data=buildRequestData(apiElement);data.channel="web-api",fetch(window.uSizy.URL+"/api/v1/display-button",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(data)}).then((function(response){response.ok&&response.json().then(apiCallResponse)}))}function _saveSk(sk){storageAvailable("localStorage")&&window.localStorage.setItem("usizy.sk",sk),document.cookie="usizy.sk="+sk+"; path=/; max-age=63072000; SameSite=None; Secure"}function externalListener(buttonElement,data){buttonElement.firstElementChild&&"empty"!==data.kind&&(buttonElement.firstElementChild.style.display="block",data.height&&(buttonElement.firstElementChild.style.height=data.height)),_saveSk(data.sk),data.kind&&("popup"===data.kind||"chart"===data.kind?window.uSizy.associated_product():"empty"!==data.kind&&"guide"!==data.kind||window.uSizy.unassociated_product()),buildNextButtonElement()}function lightStartAppListener(buttonElement,data){const uslboxId=data.btid+"-uslbox";let lightboxContent,lightbox=document.getElementById(uslboxId);if(null===lightbox)return;lightbox.dataset.embed?lightbox.style.display="none":lightbox.style.display="inline-flex",lightboxContent=lightbox.getElementsByTagName("iframe").item(0);const body=document.querySelector("body");bodyOverflow=body.style.overflow||"",body.style.overflow="hidden";const message={subject:"LOADED",btid:buttonElement.dataset.btid,screen_width:window.screen.width,screen_height:window.innerHeight};lightboxContent.contentWindow.postMessage(message,"*");let iframes=buttonElement.getElementsByTagName("iframe");iframes.length>=1&&null!==iframes[0].contentWindow&&iframes[0].contentWindow.postMessage(message,"*"),window.postMessage(message,"*")}function finishAppLoader(buttonElement,data,contentDoc){let el=contentDoc.getElementById("q-app");const img_src=window.uSizy.get_img();img_src&&(el.dataset.img=img_src);const stockSizes=window.uSizy.get_stock_sizes();if(stockSizes&&(el.dataset.stockSizes=stockSizes),data.language&&(buttonElement.dataset.language=data.language,el.dataset.language=data.language),buttonElement.dataset.country&&(el.dataset.country=buttonElement.dataset.country),buttonElement.dataset.system&&(el.dataset.sizesystem=encodeURIComponent(buttonElement.dataset.system)),buttonElement.dataset.sizesystem&&(el.dataset.sizesystem=encodeURIComponent(buttonElement.dataset.sizesystem)),buttonElement.dataset.metricsystem&&(el.dataset.metricsystem=encodeURIComponent(buttonElement.dataset.metricsystem)),buttonElement.dataset.weightsystem&&(el.dataset.weightsystem=encodeURIComponent(buttonElement.dataset.weightsystem)),data.js){let js;for(let i=0,length_js=data.js.length;i<length_js;i+=1)js=contentDoc.createElement("script"),contentDoc.body.appendChild(js),js.src=data.js[i]}}function embedContentAppLoader(buttonElement,data,contentDoc,lightbox){contentDoc.getElementById("q-app")||(contentDoc.head.insertAdjacentHTML("afterbegin",window.uSizy.FONT),lightbox.insertAdjacentHTML("beforeend",data.app),lightbox.dataset.embed="true"),finishAppLoader(buttonElement,data,contentDoc)}function lightContentAppLoader(buttonElement,data,contentDoc){contentDoc.head.textContent="",contentDoc.head.insertAdjacentHTML("afterbegin",window.uSizy.FONT),contentDoc.body.textContent="",contentDoc.body.insertAdjacentHTML("afterbegin",data.app),finishAppLoader(buttonElement,data,contentDoc)}function allowedOrigin(origin){return"null"===origin||~origin.indexOf(window.uSizy.URL)||~origin.indexOf(window.location.origin)||~origin.indexOf("about:")}function isIphone(){return!!navigator.userAgent.match(/iPhone/i)}function isIE(){return"ActiveXObject"in window}function doResize(lightboxContent){let iHeight=window.screen.height;isIphone()&&iHeight>=667&&iHeight-window.innerHeight<100?lightboxContent.style.height=window.innerHeight-100+"px":lightboxContent.style.height=window.innerHeight+"px"}function checkVisibilityChange(){uSizy.buttonsMap.forEach((function(button_list,product){selectVisibleButtons(product,button_list)}))}function resizeEmitter(lightboxContent){window.addEventListener("resize",(function(){doResize(lightboxContent)}))}function lightAppIframe(buttonElement,data){const uslboxId=data.btid+"-uslbox";let lightboxContent,lightbox=document.getElementById(uslboxId);null===lightbox?(document.body.insertAdjacentHTML("beforeend",data.wrapper),lightbox=document.getElementById(uslboxId),lightboxContent=lightbox.getElementsByTagName("iframe").item(0),lightboxContent.src="about:blank",lightboxContent.onload=function(){lightContentAppLoader(buttonElement,data,lightboxContent.contentDocument)},doResize(lightboxContent),resizeEmitter(lightboxContent)):(lightboxContent=lightbox.getElementsByTagName("iframe").item(0),lightContentAppLoader(buttonElement,data,lightboxContent.contentDocument))}function lightAppEmbed(buttonElement,data){const uslboxId=data.btid+"-uslbox";let lightbox=document.getElementById(uslboxId);null===lightbox&&(document.body.insertAdjacentHTML("beforeend",data.wrapper),lightbox=document.getElementById(uslboxId)),embedContentAppLoader(buttonElement,data,document,lightbox)}function lightAppListener(buttonElement,event){"null"===event.origin?lightAppEmbed(buttonElement,event.data):lightAppIframe(buttonElement,event.data)}function resizeListener(data){const uslboxId=data.btid+"-uslbox";let lightboxContent=document.getElementById(uslboxId).getElementsByTagName("iframe").item(0);null!==lightboxContent&&(lightboxContent.style.height=data.height+30+"px")}function closeListener(data){const uslboxId=data.btid+"-uslbox";let lightbox=document.getElementById(uslboxId);lightbox&&(lightbox.style.display="none",document.querySelector("body").style.overflow=bodyOverflow)}function buildButtonElement(buttonElement){uSizy.loadedSet.has(buttonElement)||(buttonElement.dataset.url&&(window.uSizy.URL=buttonElement.dataset.url),window.addEventListener("message",(function(event){if(window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),allowedOrigin(event.origin)){if(event.data.btid&&buttonElement.dataset.btid!==event.data.btid)return;"EXTERNAL"===event.data.subject?externalListener(buttonElement,event.data):"LIGHT_APP"===event.data.subject?lightAppListener(buttonElement,event):"START_APP"===event.data.subject&&lightStartAppListener(buttonElement,event.data)}}),!1),buildWebComponent(buttonElement),uSizy.loadedSet.add(buttonElement))}function buildApiElement(apiElement){uSizy.loadedSet.has(apiElement)||(apiElement.dataset.url&&(window.uSizy.URL=apiElement.dataset.url),buildApiCall(apiElement),uSizy.loadedSet.add(apiElement))}function addGlobalMessageListeners(){setEventListener("resize",window,"resize",(function(){checkVisibilityChange()})),setEventListener("message",window,"message",(function(event){window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),allowedOrigin(event.origin)&&("CLOSE"===event.data.subject?closeListener(event.data):"RESIZE"===event.data.subject?resizeListener(event.data):"PRODUCT"===event.data.subject?saveProduct(event.data):"ADD_TO_CART"===event.data.subject?window.uSizy.add_to_cart(event.data):"ASSOCIATED_FUNCTION"===event.data.subject?eval("uSizy.associated_product = "+decodeURI(event.data.func)):"ASSOCIATED_CALL"===event.data.subject?window.uSizy.associated_product():"UNASSOCIATED_FUNCTION"===event.data.subject?eval("uSizy.unassociated_product = "+decodeURI(event.data.func)):"UNASSOCIATED_CALL"===event.data.subject?window.uSizy.unassociated_product():"LAUNCH_GUIDE"===event.data.subject&&(window.uSizy.push({event:"GUIDE",uid:event.data.uid,product:event.data.product,price:event.data.price}),eval("uSizy.unassociated_product = "+decodeURI(event.data.func)),window.uSizy.unassociated_product()))}),!1)}function buildNextButtonElement(){let value=mapIterator.next().value;void 0!==value&&selectVisibleButtons(value[0],value[1])}function sendQueuedEvents(){queuedEvents.forEach((function(event){uSizy.push(event)}))}function ready(){sendQueuedEvents(),addGlobalMessageListeners(),buttonElements=document.getElementsByClassName("usizy-external"),uSizy.buttonsMap=loadMap(buttonElements),mapIterator=uSizy.buttonsMap.entries(),buildNextButtonElement();let apiElements=document.getElementsByClassName("usizy-api");uSizy.apisMap=loadMap(apiElements),uSizy.apisMap.forEach((function(apiList){apiList.forEach((function(apiElement){buildApiElement(apiElement)}))}))}function pageview(){void 0===window.uSizyUniversal_initialized&&(window.uSizyUniversal_initialized=!0,uSizy.view({event:"PAGEVIEW",ref:window.top.location}))}function init(){isIE()||domReady("DOMContentLoaded",ready)}void 0!==window.uSizy&&void 0!==window.uSizy.init||(window.uSizy={URL:void 0!==window.uSizy&&void 0!==window.uSizy.URL?uSizy.URL:"https://usizy.com",init:init,get_img:function(){},add_to_cart:function(data){},get_stock_sizes:function(){},associated_product:function(){},unassociated_product:function(){},FONT:'<link href="https://fonts.googleapis.com/css?family=Material+Icons|Roboto:100,300,400,500,700" rel="stylesheet">',buttonsMap:new Map,apisMap:new Map,loadedSet:new Set,globalListener:new Set,push:function(event){const eventType=event.event.toLowerCase();let data={};for(let p in event)event.hasOwnProperty(p)&&(data[p]=event[p]);if("confirm"===eventType){const all_keys=new Set(Object.keys(data));if(0===intersection(all_keys,new Set(["order_id","order"])).size)throw new TypeError("Field order_id is required");if(0===intersection(all_keys,new Set(["product_ids","products","product_id","product","item_group_id"])).size)throw new TypeError("Field product_ids is required")}let sk=_loadSk();sk&&"undefined"!==sk&&(data.sk=sk);let ref=window.top.location.protocol+"//"+window.top.location.hostname;ref&&"undefined"!==ref&&(data.ref=ref);let url=window.uSizy.URL+"/api/v2/event/"+eventType,oReq=new XMLHttpRequest;oReq.open("POST",url,!0),oReq.setRequestHeader("Content-Type","application/json"),oReq.withCredentials=!0,oReq.send(JSON.stringify(data)),window.postMessage(event,"*")},view:function(event){let data=new FormData;for(let p in event)event.hasOwnProperty(p)&&data.append(p,event[p]);let sk=_loadSk();sk&&"undefined"!==sk&&data.append("sk",sk),fetch(window.uSizy.URL+"/external/pageview",{method:"POST",credentials:"include",body:data})}});try{const manualInit=document.currentScript.dataset.manual_init;manualInit||init()}catch(e){init()}domReady("DOMContentLoadedPage",pageview)})(window,document);