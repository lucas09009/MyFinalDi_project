if (undefined === window.Kameleoon){(function(){!function(e,t){e.kbowser=t()}(this,(function(){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=90)}({17:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var i=r(18),n=function(){function e(){}return e.getFirstMatch=function(e,t){var r=t.match(e);return r&&r.length>0&&r[1]||""},e.getSecondMatch=function(e,t){var r=t.match(e);return r&&r.length>1&&r[2]||""},e.matchAndReturnConst=function(e,t,r){if(e.test(t))return r},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,r,i){void 0===i&&(i=!1);var n=e.getVersionPrecision(t),s=e.getVersionPrecision(r),o=Math.max(n,s),a=0,u=e.map([t,r],(function(t){var r=o-e.getVersionPrecision(t),i=t+new Array(r+1).join(".0");return e.map(i.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(i&&(a=o-Math.min(n,s)),o-=1;o>=a;){if(u[0][o]>u[1][o])return 1;if(u[0][o]===u[1][o]){if(o===a)return 0;o-=1}else if(u[0][o]<u[1][o])return-1}},e.map=function(e,t){var r,i=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(r=0;r<e.length;r+=1)i.push(t(e[r]));return i},e.find=function(e,t){var r,i;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(r=0,i=e.length;r<i;r+=1){var n=e[r];if(t(n,r))return n}},e.assign=function(e){for(var t,r,i=e,n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];if(Object.assign)return Object.assign.apply(Object,[e].concat(s));var a=function(){var e=s[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){i[t]=e[t]}))};for(t=0,r=s.length;t<r;t+=1)a();return e},e.getBrowserAlias=function(e){return i.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return i.BROWSER_MAP[e]||""},e}();t.default=n,e.exports=t.default},18:function(e,t,r){"use strict";t.__esModule=!0,t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0;t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex"};t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"};t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop"};t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",Linux:"Linux"}},90:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var i,n=(i=r(91))&&i.__esModule?i:{default:i},s=r(18);function o(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(){}var t,r,i;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new n.default(e,t)},e.parse=function(e){return new n.default(e).getResult()},t=e,i=[{key:"BROWSER_MAP",get:function(){return s.BROWSER_MAP}},{key:"OS_MAP",get:function(){return s.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return s.PLATFORMS_MAP}}],(r=null)&&o(t.prototype,r),i&&o(t,i),e}();t.default=a,e.exports=t.default},91:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var i=a(r(92)),n=a(r(93)),s=a(r(94)),o=a(r(17));function a(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=o.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=o.default.find(n.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=o.default.find(s.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this},t.getResult=function(){return o.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,r={},i=0,n={},s=0;if(Object.keys(e).forEach((function(t){var o=e[t];"string"==typeof o?(n[t]=o,s+=1):"object"==typeof o&&(r[t]=o,i+=1)})),i>0){var a=Object.keys(r),u=o.default.find(a,(function(e){return t.isOS(e)}));if(u){var c=this.satisfies(r[u]);if(void 0!==c)return c}var d=o.default.find(a,(function(e){return t.isPlatform(e)}));if(d){var f=this.satisfies(r[d]);if(void 0!==f)return f}}if(s>0){var l=Object.keys(n),h=o.default.find(l,(function(e){return t.isBrowser(e,!0)}));if(void 0!==h)return this.compareVersion(n[h])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var r=this.getBrowserName().toLowerCase(),i=e.toLowerCase(),n=o.default.getBrowserTypeByAlias(i);return t&&n&&(i=n.toLowerCase()),i===r},t.compareVersion=function(e){var t=[0],r=e,i=!1,n=this.getBrowserVersion();if("string"==typeof n)return">"===e[0]||"<"===e[0]?(r=e.substr(1),"="===e[1]?(i=!0,r=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?r=e.substr(1):"~"===e[0]&&(i=!0,r=e.substr(1)),t.indexOf(o.default.compareVersions(n,r,i))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.is=function(e){return this.isBrowser(e)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=u,e.exports=t.default},92:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var i,n=(i=r(17))&&i.__esModule?i:{default:i};var s=/version\/(\d+(\.?_?\d+)+)/i,o=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},r=n.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||n.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},r=n.default.getFirstMatch(s,e)||n.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},r=n.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||n.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},r=n.default.getFirstMatch(s,e)||n.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},r=n.default.getFirstMatch(s,e)||n.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},r=n.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||n.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},r=n.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||n.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},r=n.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||n.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},r=n.default.getFirstMatch(s,e)||n.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},r=n.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||n.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},r=n.default.getFirstMatch(s,e)||n.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},r=n.default.getFirstMatch(s,e)||n.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},r=n.default.getFirstMatch(s,e)||n.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},r=n.default.getFirstMatch(s,e)||n.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},r=n.default.getFirstMatch(s,e)||n.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},r=n.default.getFirstMatch(s,e)||n.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},r=n.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||n.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},r=n.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||n.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},r=n.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},r=n.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},r=n.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},r=n.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},r=n.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},r=n.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return r&&(t.version=r),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},r=n.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},r=n.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},r=n.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},r=n.default.getFirstMatch(s,e)||n.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},r=n.default.getFirstMatch(s,e)||n.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},r=n.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},r=n.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||n.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},r=n.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||n.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},r=n.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},r=n.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},r=n.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||n.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},r=n.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},r=n.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t={name:"Android Browser"},r=n.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},r=n.default.getFirstMatch(s,e);return r&&(t.version=r),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:n.default.getFirstMatch(t,e),version:n.default.getSecondMatch(t,e)}}}];t.default=o,e.exports=t.default},93:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var i,n=(i=r(17))&&i.__esModule?i:{default:i},s=r(18);var o=[{test:[/windows phone/i],describe:function(e){return{name:s.OS_MAP.WindowsPhone}}},{test:[/windows /i],describe:function(e){return{name:s.OS_MAP.Windows}}},{test:[/Macintosh(.*?) FxiOS(.*?) Version\//],describe:function(e){return{name:s.OS_MAP.iOS}}},{test:[/macintosh/i],describe:function(e){return{name:s.OS_MAP.MacOS}}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){return{name:s.OS_MAP.iOS}}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t=n.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),r=n.default.getAndroidVersionName(t),i={name:s.OS_MAP.Android,version:t};return r&&(i.versionName=r),i}},{test:[/linux/i],describe:function(){return{name:s.OS_MAP.Linux}}}];t.default=o,e.exports=t.default},94:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var i,n=(i=r(17))&&i.__esModule?i:{default:i},s=r(18);var o=[{test:[/googlebot/i],describe:function(){return{type:"bot"}}},{test:[/huawei/i],describe:function(e){return{type:s.PLATFORMS_MAP.mobile}}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet}}},{test:[/ipad/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet}}},{test:[/Macintosh(.*?) FxiOS(.*?) Version\//],describe:function(){return{type:s.PLATFORMS_MAP.tablet}}},{test:[/kftt build/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet}}},{test:[/silk/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:s.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),r=e.test(/like (ipod|iphone)/i);return t&&!r},describe:function(e){return{type:s.PLATFORMS_MAP.mobile}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:[/[^-]mobi/i],describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:function(e){return"android"===e.getOSName(!0)&&Number(String(e.getOSVersion()).split(".")[0])>=3},describe:function(){return{type:s.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.desktop}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:s.PLATFORMS_MAP.desktop}}}];t.default=o,e.exports=t.default}})}));class APIConfiguration{constructor(e){this.generationTime=e.scriptProduceTime;this.goals=e.goals.map((e=>new APIGoal(e)));this.singlePageSupport=Kameleoon.Internals.runtime?Kameleoon.Internals.runtime.singlePageSupport:e.singlePageSupport;this.siteCode=e.siteCode}}class APIAction{constructor(i,t){this.dateLaunched=i.dateStatusModified;this.dateModified=i.dateModified;this.id=i.id;this.name=i.name;this.targetSegment=new APISegment(i.targetingSegment);this.active=i.targeting&&!i.disabled&&i.displayedVariation&&null!=i.displayedVariation.id;this.triggered=i.targeting||!1;this.goals=Kameleoon.Internals.configuration.goals.filter((t=>-1!=(i.goals||[]).indexOf(t.id))).map((i=>new APIGoal(i)));this.untrackedTrafficReallocationTime=i.untrackedRespoolTime||null;let e=i=>{let t=Kameleoon.Internals.runtime.variations.filter((t=>t.id==i));return t&&t[0]};const a=Kameleoon.Internals.runtime.Visitor.currentVisit;if("experiments"==t){this.mainGoal=i.kameleoonTracking&&i.kameleoonTracking.mainGoalId?new APIGoal(Kameleoon.Internals.configuration.goals.filter((t=>t.id==i.kameleoonTracking.mainGoalId))[0]):null;let t=e(i.registeredVariationId);this.associatedVariation=t?new APIVariation(t,i):null;this.trafficDeviation={};this.variations=[];this.redirectProcessed=i.redirectProcessed||!1;for(let t in i.deviation){this.trafficDeviation[t]=100*i.deviation[t];this.variations.push(new APIVariation(e(parseInt(t)),i))}let n=Kameleoon.Internals.runtime.storedData.obtainField("Gatherer","experimentsTriggered",{});this.triggeredInVisit=n[this.id]?!0:!1;this.activatedInVisit=a.ExperimentActivations[this.id]?!0:!1}else{this.mainGoal=new APIGoal(Kameleoon.Internals.configuration.goals.filter((t=>t.id==i.mainGoalId))[0]);this.associatedVariation=new APIVariation(e(i.associatedVariation.id),i);let t=Kameleoon.Internals.runtime.storedData.obtainField("Gatherer","personalizationsTriggered",{});this.triggeredInVisit=t[this.id]?!0:!1;this.activatedInVisit=this.triggeredInVisit&&a.PersonalizationActivations[this.id]?!0:!1}}}class APIActionActivation{constructor(i,t,n){let a;let e;if("experiment"==i){this.times=n.ExperimentActivations[t].times;this.experimentID=t;a=Kameleoon.Internals.runtime.Campaigns.obtainCampaign(t,"experiment");e=n.ExperimentActivations[t].associatedVariationID;this.experiment=a?new APIAction(a,"experiments"):null}else{this.times=n.PersonalizationActivations[t].times;this.personalizationID=t;a=Kameleoon.Internals.runtime.Campaigns.obtainCampaign(t,"personalization");e=n.PersonalizationActivations[t].associatedVariationID;this.personalization=a?new APIAction(a,"personalizations"):null}this.associatedVariationID=e;let o=Kameleoon.Internals.configuration.variations.filter((i=>i.id==e))[0];this.associatedVariation=o?new APIVariation(o,a):null}}class APIActions{constructor(e){let i=e;let t=()=>{if(Kameleoon.Internals.runtime)return Kameleoon.Internals.runtime.Campaigns.obtainCampaignsList(i);else return[]};this.getAll=()=>t().map((e=>new APIAction(e,i)));this.getActive=()=>t().filter((e=>!0===e.targeting&&1!=e.disabled&&e.displayedVariation&&null!=e.displayedVariation.id)).map((e=>new APIAction(e,i)));this.getTriggeredInVisit=()=>t().map((e=>new APIAction(e,i))).filter((e=>e.triggeredInVisit));this.getActivatedInVisit=()=>t().map((e=>new APIAction(e,i))).filter((e=>e.activatedInVisit));let n=(e,n)=>{let a=t().filter((i=>i[e]==n))[0];if(a)return new APIAction(a,i);return null};this.getById=e=>n("id",e);this.getByName=e=>n("name",e);if("experiments"==i){this.assignVariation=(e,i,n)=>{let a=t().filter((i=>i.id==e))[0];if(a)if(void 0===a.registeredVariationId||n){a.registeredVariationId=i;a.assignmentTime=(new Date).getTime();a.writeLocalData()}};this.block=(e,i=!1)=>{let t=Kameleoon.Internals.runtime.Campaigns.obtainCampaign(e,"experiment");if(t){if(i){let i=Kameleoon.Internals.runtime.storedData.obtainField("Runtime","blockedExperiments",[]);i.push(e);Kameleoon.Internals.runtime.storedData.saveField("Runtime","blockedExperiments",i)}t.blocked=!0}};this.trigger=(e,i)=>{let t=Kameleoon.Internals.runtime.Campaigns.obtainCampaign(e,"experiment");if(t)if(i){if(t){t.performVariationAssignment(!0);Kameleoon.Analyst.Actions.performActionsTracking([t])}}else{t.trigger();Kameleoon.Analyst.Actions.process([t])}};this.triggerExperiment=(e,i)=>{this.trigger(e,i)}}else{this.block=(e,i=!1)=>{let t=Kameleoon.Internals.runtime.Campaigns.obtainCampaign(e,"personalization");if(t){if(i){let i=Kameleoon.Internals.runtime.storedData.obtainField("Runtime","blockedPersonalizations",[]);i.push(e);Kameleoon.Internals.runtime.storedData.saveField("Runtime","blockedPersonalizations",i)}t.blocked=!0}};this.disable=e=>{let i=Kameleoon.Internals.runtime.Campaigns.obtainCampaign(e,"personalization");if(i)i.disabled=!0};this.trigger=(e,i)=>{let t=Kameleoon.Internals.runtime.Campaigns.obtainCampaign(e,"personalization");if(t){t.exposition=!0;if(i){if(t)Kameleoon.Analyst.Actions.performActionsTracking([t])}else{t.trigger();Kameleoon.Analyst.Actions.process([t])}}}}}}class APIGoal{constructor(t){if(t){this.id=t.id;this.name=t.name;this.type=t.type}}}class APISegment{constructor(i){if(i){this.id=i.id;this.name=i.name}}}class APITemplate{constructor(s,t){this.name=s;this.customFields=t}}class APIVariation{constructor(e,t={}){if(e){this.id=e.id;this.name=e.name;if(t.experimentAction){var i=t.variations.filter((t=>t.id==e.id))[0];this.reallocationTime=i?i.respoolTime:null}else this.reallocationTime=null;this.instantiatedTemplate=e.widgetTemplateInputData?new APITemplate(e.widgetTemplateName,e.widgetTemplateInputData):null}}}class APIVisit{constructor(t){this.pageViews=t.obtainPageNumberViews();this.duration=t.lastActivityDate-t.startDate;this.locale=Kameleoon.Utils.getLocale();this.startDate=t.startDate;this.index=t.visitNumber;this.currentProduct=null;this.products=[];this.clicks=t.clicks||0;this.pageURLsVisited=t.pageURLsVisited;this.activatedSegments=t.activatedSegments;this.lastActivityDate=t.lastActivityDate;this.activatedExperiments=Object.keys(t.ExperimentActivations).map((e=>new APIActionActivation("experiment",parseInt(e),t)));this.activatedPersonalizations=Object.keys(t.PersonalizationActivations).map((e=>new APIActionActivation("personalization",parseInt(e),t)));if(t==Kameleoon.Internals.runtime.Visitor.currentVisit){this.device=new Device;this.geolocation=t.Geolocation;}this.conversions=Kameleoon.Utils.clone(t.conversions);this.customData={};let e=Kameleoon.Internals.runtime.Gatherer.configuration.customData;for(let i in t.customData){let n=e[i];if(null!=n)this.customData[n.name]=Kameleoon.Gatherer.CustomData.obtainParsedValue(i,t.customData[i])}let i="<OTHER / UNKNOWN>";let n=[];let a=Kameleoon.Internals.runtime.storedData.obtainField("Runtime","firstReferrersIndices",[]);for(let t=0,e=a.length;t<e;t++){let e=a[t];let s;if(0==e)s="<RESTART>";else{let t=Kameleoon.Internals.runtime.Gatherer.configuration.referrers[e-1];s=null==t?i:t.name}n.push(s)}this.acquisitionChannel=n[0];this.landingPageURL=t.landingPageURL;this.weather=new APIWeather(t)}}class APIVisitor{constructor(){this.getCustomDataVisitor=()=>{let t={};let i=Kameleoon.Internals.runtime.Visitor.customData;let e=Kameleoon.Internals.runtime.Gatherer.configuration.customData;for(let s in i)t[e[s].name]=Kameleoon.Gatherer.CustomData.obtainParsedValue(s,i[s]);return t};this.setVisitorCode=t=>{Kameleoon.Internals.runtime.Visitor.setVisitorCode(t)};this.numberOfVisits=Kameleoon.Internals.runtime.Visitor.totalVisits;this.timeStartedEldestVisit=Kameleoon.Internals.runtime.Visitor.timeStartedEldestVisit;this.customData=this.getCustomDataVisitor();this.personalizationsActive=Kameleoon.Internals.runtime.personalizationsActive;this.code=Kameleoon.Internals.runtime.Visitor.currentVisit.visitorCode;this.currentVisit=new APIVisit(Kameleoon.Internals.runtime.Visitor.currentVisit);this.visits=Kameleoon.Internals.runtime.Visitor.visits.map((t=>new APIVisit(t)));this.previousVisit=Kameleoon.Internals.runtime.Visitor.visits.length>1?new APIVisit(Kameleoon.Internals.runtime.Visitor.visits.slice(-2)[0]):null;this.experimentLegalConsent=Kameleoon.Internals.runtime.Consent.AB_TESTING;this.personalizationLegalConsent=Kameleoon.Internals.runtime.Consent.PERSONALIZATION;this.firstVisitStartDate=Kameleoon.Internals.runtime.Visitor.timeStartedEldestVisit}}class APIWeather{constructor(i){let s=i.Weather;this.temperature=s.temperature;this.humidity=s.humidity;this.pressure=s.pressure;this.windSpeed=s.windSpeed;this.cloudiness=s.cloudiness;this.sunrise=s.sunrise;this.sunset=s.sunset;this.conditionCode=s.conditionCode;this.conditionDescription=s.conditionDescription}}class Analyst{constructor(){this.initialize=e=>{this.isTimeout=!1;if(window.kameleoonDisplayPage){if(null==Kameleoon.Internals.configuration.behaviorWhenTimeout||document.getElementById("kameleoonLoadingStyleSheet"))window.clearTimeout(window.kameleoonDisplayPageTimeOut);else if(null==window.kameleoonEndLoadTime)this.isTimeout=!0;try{window.kameleoonDisplayPage(!0)}catch(e){}window.kameleoonDisplayPage=null}window.kameleoonEndLoadTime=(new Date).getTime();e()};this.load=()=>{Kameleoon.Utils.sendKameleoonCustomEvent("Internals",{type:"load",time:(new Date).getTime()});Kameleoon.Utils.runProtectedFunction((function(){if(window.kameleoonQueue)window.kameleoonQueue=new CommandQueue(window.kameleoonQueue,"IMMEDIATE");if(window.kameleoonAddCustomAction){Kameleoon.Utils.runProtectedScript(window.kameleoonAddCustomAction,"kameleoonAddCustomActionScript.js");delete window.kameleoonAddCustomAction}if(window.kameleoonAddCustomGlobalScript){Kameleoon.Internals.configuration.globalScript=window.kameleoonAddCustomGlobalScript;delete window.kameleoonAddCustomGlobalScript}window.addEventListener("error",(e=>{if(e.error&&e.error.stack&&e.error.stack.match(/kameleoon/gi)){Kameleoon.Utils.Logger.send(e.error.stack,"kameleoon.js");return!1}}));Kameleoon.Analyst.initialize((()=>{const e=Kameleoon.Analyst.checkBlockingElements();const o=window.kameleoonEndLoadTime-(window.kameleoonStartLoadTime||window.kameleoonEndLoadTime)-25;Kameleoon.Utils.sendKameleoonCustomEvent.call(window,"Loaded",{timeout:"TIMEOUT"==e,loadTime:o});if(Kameleoon.Internals.runtime)Kameleoon.Internals.runtime.clear();if(0==e.length){Kameleoon.Internals.runtime=new Runtime;Kameleoon.Analyst.loadKameleoonFull((()=>{Kameleoon.Internals.runtime.run()}))}else{Kameleoon.Utils.sendKameleoonCustomEvent("Internals",{type:"abort",blockingReason:e});Kameleoon.Utils.sendKameleoonCustomEvent.call(window,"Aborted",{reason:e})}}))}))};this.loadKameleoonFull=(e,o)=>{if(!Kameleoon.Internals.runtime.kameleoonFull&&(this.kameleoonFullNeeded()||o)){const o=o=>{Kameleoon.Utils.runProtectedScript(o+"\n;"+"("+e.toString()+")()","kameleoonFull.js")};const n=sessionStorage.getItem("kameleoonFullApplicationCode");if(null!=n)o(n);else Kameleoon.Utils.performBeaconServerCall("https://"+Kameleoon.Internals.configuration.STATIC_HOST_NAME+"."+Kameleoon.Internals.configuration.DOMAIN+"/kameleoon-full.js?cache="+Kameleoon.Utils.obtainRandomString(16),(e=>{if(void 0===e.readyState||4==e.readyState&&200==e.status){sessionStorage.setItem("kameleoonFullApplicationCode",e.responseText);o(e.responseText)}}))}else e()};this.Goals=new Goals}checkBlockingElements(){const e=new Device;if("Internet Explorer"==e.browser&&e.browserVersion<=(Kameleoon.Internals.configuration.wideEngineSupport?10:12)||"Opera"==e.browser&&e.browserVersion<13)return"BROWSER";let o=!1;try{if(window.localStorage||window.sessionStorage){localStorage.getItem("kameleoonPrivateMode");sessionStorage.getItem("kameleoonPrivateMode")}else o=!0}catch(e){o=!0}if(o)return"STORAGE";if(this.isTimeout){switch(Kameleoon.Internals.configuration.behaviorWhenTimeout){case"VISIT":sessionStorage.setItem("kameleoonDisabledForVisit","true");break;default:break}return"TIMEOUT"}document.removeEventListener("visibilitychange",Kameleoon.Analyst.load);if("prerender"==document.visibilityState){document.addEventListener("visibilitychange",Kameleoon.Analyst.load);return"PRERENDER"}if(-1!=location.href.indexOf("kameleoonDisabled"))return"PARAMETER";if(Kameleoon.Internals.configuration.kameleoonDisabled)return"DISABLED";return""}kameleoonFullNeeded(){if(sessionStorage.getItem("kameleoonFullApplicationCode")||sessionStorage.getItem("kameleoonLightExtension")||Kameleoon.Internals.runtime.parameters.kameleoon||Kameleoon.Internals.runtime.parameters.kameleoonVariationId||Kameleoon.Internals.runtime.parameters["kameleoon-simulation"]||Kameleoon.Internals.runtime.parameters.kameleoonLightExtension||Kameleoon.Internals.runtime.simulationMode||Kameleoon.Utils.readLocalData("kameleoonSimulationParameters","COOKIE"))return!0;return!1}loadSimulation(){if(!Kameleoon.Internals.runtime.parameters.kameleoonVariationId)Object.keys(localStorage).forEach((e=>{if(-1!==e.indexOf("kameleoonVariation-"))localStorage.removeItem(e)}))}loadVariationFromServer(e,o){}processSimulations(){}}Analyst.CODE_ALPHABET="abcdefghijklmnopqrstuvwxyz0123456789";class API{constructor(){this.Core={enableLegalConsent:function(e="BOTH"){Kameleoon.Internals.runtime.Consent.enable(e)},disableLegalConsent:function(e="BOTH"){Kameleoon.Internals.runtime.Consent.disable(e)},enableSinglePageSupport:function(){Kameleoon.Internals.runtime.enableSinglePageSupport.apply(Kameleoon.Internals.runtime,arguments)},enableDynamicRefresh:function(){Kameleoon.Internals.runtime.enableDynamicRefresh.apply(Kameleoon.Internals.runtime,arguments)},getConfiguration:()=>new APIConfiguration(Kameleoon.Internals.configuration),load:function(){Kameleoon.Analyst.load.apply(Kameleoon.Analyst,arguments)},processRedirect:function(){Kameleoon.Utils.processRedirect.apply(Kameleoon.Utils,arguments)},runWhenConditionTrue:(e,n,t=200)=>{if(e())Kameleoon.Utils.runProtectedFunction(n,!0);else{const o=Kameleoon.Utils.setTimeout((()=>{Kameleoon.Utils.clearTimeout(o);this.Core.runWhenConditionTrue.apply(Kameleoon,[e,n,t])}),t,!0)}},runWhenElementPresent:(e,n,t,o)=>{const a=null==t;const r=Kameleoon.Utils.querySelectorAll(e);const i=n;if(o)n=n=>{KMutationObserver.setMutationObserverSPA();const t=`data-kameleoon-dynamic-class-${Kameleoon.Utils.obtainRandomString(4)}`;const o=e=>{e.forEach((e=>e.setAttribute(t,"true")))};o(n);i(n);Kameleoon.Internals.runtime.waitingDynamicElements.push({selector:e,attribute:t,callback:e=>{o(e);i(e)}})};if(!Kameleoon.Internals.runtime.querySelectorAllHasError)if(0<r.length)Kameleoon.Utils.runProtectedFunction((()=>{n(r)}),!0);else if(Kameleoon.Internals.runtime.cantUseMutationObserver||!a){const n=Kameleoon.Utils.setTimeout((()=>{Kameleoon.Utils.clearTimeout(n);this.Core.runWhenElementPresent.apply(Kameleoon,[e,i,t||200,o])}),t||200,!0)}else Kameleoon.Internals.runtime.waitingElementPresentObjects.push({selector:e,callback:n,useAntiFlicker:a})}};this.Goals={cancelConversion:(e,n)=>{try{this.Goals.processConversions(e,n,!0)}catch(e){}},processConversion:(e,n)=>{try{this.Goals.processConversions(e,n,!1)}catch(e){}},processConversions:(e,n,t)=>{Kameleoon.Internals.runtime.goals.forEach((o=>{if(e==o.id||e==o.name)Kameleoon.Analyst.Goals.processConversions([{goal:o,revenue:n,negative:t}])}))}};this.Data={readLocalData:e=>Kameleoon.Internals.runtime.storedData.Vars[e]?Kameleoon.Internals.runtime.storedData.Vars[e].value:null,resetCustomData:e=>{this.Data.setCustomData(e,[],!0)},retrieveDataFromRemoteSource:(e,n)=>{const t={siteCode:Kameleoon.Internals.configuration.siteCode};let o="map";if(e instanceof Array){o="maps";t.keys=encodeURIComponent(JSON.stringify(e))}else t.key=encodeURIComponent(e.toString());Kameleoon.Utils.performBeaconServerCall(Kameleoon.Utils.addParameterToURL(`${Kameleoon.Internals.runtime.DATA_URL}/map/${o}`,Kameleoon.Utils.parseObjectToUrlParams(t),!1),(e=>{if(4==e.readyState){let t={};if(200==e.status)t=JSON.parse(e.responseText);n&&n(t)}}),null)},setCustomData:(e,n,t=!1)=>{if(Kameleoon.Internals.runtime&&Kameleoon.Internals.runtime.gathererRun){let o=null;for(const n in Kameleoon.Internals.runtime.Gatherer.configuration.customData){const t=Kameleoon.Internals.runtime.Gatherer.configuration.customData[n];if(null!=t&&t.name==e){o=parseInt(n);break}}if(null!=o)Kameleoon.Gatherer.CustomData.register(o,{value:n,overwrite:t})}},writeLocalData:(e,n,t)=>{Kameleoon.Internals.runtime.storedData.Vars[e]={value:n,date:(new Date).getTime()+24*60*60*1e3*(t?30:1/24)}},performRemoteSynchronization:(e,n,t)=>{}};this.Events={triggered:[],trigger:e=>{this.Core.runWhenConditionTrue((()=>!0===Kameleoon.Internals.runtime.setupAfterLocalDataRetrieval),(()=>{this.Events.triggered.push(e);if(Kameleoon.Analyst.Actions)Kameleoon.Analyst.Actions.processAllActions();if(Kameleoon.Targeting)Kameleoon.Targeting.processAllTargetingSegments();}),100)}};this.Tracking={processOmniture:e=>{Kameleoon.Tracking.processOmniture&&Kameleoon.Tracking.processOmniture(e)}};this.Experiments=new APIActions("experiments");this.Personalizations=new APIActions("personalizations");this.Segments={getAll:()=>Kameleoon.Internals.runtime.targetingSegments.map((e=>new APISegment(e))),getById:e=>{const n=Kameleoon.Internals.runtime.targetingSegments.filter((n=>n.id==e))[0];return n?new APISegment(n):null},getByName:e=>{const n=Kameleoon.Internals.runtime.targetingSegments.filter((n=>n.name==e))[0];return n?new APISegment(n):null},reevaluate:e=>{let n=-1;for(let t=0;t<(Kameleoon.Internals.runtime.targetingSegments||[]).length;t++){const o=Kameleoon.Internals.runtime.targetingSegments[t];if(o.id==e){n=t;break}}if(n>-1){let t;if(Kameleoon.Internals.runtime.simulationMode)t=Kameleoon.Internals.runtime.simulationModeData.targetingSegments.filter((n=>n.id==e))[0];else t=Kameleoon.Internals.configuration.targetingSegments.filter((n=>n.id==e))[0];if(t){Kameleoon.Internals.runtime.targetingSegments.splice(n,1);const o=Kameleoon.Utils.clone(t);Kameleoon.Internals.runtime.targetingSegments.push(o);Kameleoon.Targeting.checkTargetingSegmentsTargeting([o]);Kameleoon.Internals.runtime.Campaigns.obtainCampaignsList("experiments").concat(Kameleoon.Internals.runtime.Campaigns.obtainCampaignsList("personalizations")).forEach((n=>{n.setTargetingSegment(e);if(n.targetingSegmentId==e)n.forceTargeting=!1}));Kameleoon.Analyst.Actions.processAllActions();return o.targeting}}return;},trigger:e=>{const n=Kameleoon.Internals.runtime.targetingSegments.filter((n=>n.id==e));if(n.length>0){n[0].targeting=!0;Kameleoon.Internals.runtime.Campaigns.obtainCampaignsList("experiments").concat(Kameleoon.Internals.runtime.Campaigns.obtainCampaignsList("personalizations")).forEach((n=>{if(n.targetingSegmentId==e){n.targeting=void 0;n.rescheduleTargeting=!0;n.forceTargeting=!0}}));Kameleoon.Analyst.Actions.processAllActions();Kameleoon.Targeting.processTargetingSegments(n)}}};this.Variations={execute:e=>{const n=e=>{const n=Kameleoon.Internals.runtime.variations.filter((n=>n.id==e));return n?n[0]:null};let t=n(e);if(t){t=new Variation(t);if(t.redirections)t.preProcessRedirect();Kameleoon.Utils.addCSSStyleSheet(t.cssCode);return t.applyJavascriptCode(!0)}return null}};this.Utils={addEventListener:function(e,n,t,o){Kameleoon.Utils.addEventListener(e,n,t,o,!0)},addUniversalClickListener:function(e,n,t){this.addEventListener(e,Kameleoon.Internals.runtime.mouseDownEvent,(function(e){if(!Kameleoon.Internals.runtime.touchMoveEvent&&("mousedown"==Kameleoon.Internals.runtime.mouseDownEvent||!e.target||!e.target.closest||!e.target.closest("[disabled]")))n&&n(e)}))},clearInterval:function(){Kameleoon.Utils.clearInterval.apply(Kameleoon.Utils,arguments)},clearTimeout:function(){Kameleoon.Utils.clearTimeout.apply(Kameleoon.Utils,arguments)},createHash:function(e){return Kameleoon.Utils.computeStringHash.apply(Kameleoon.Utils,arguments)},getURLParameters:function(){return Kameleoon.Utils.parseParameters.apply(Kameleoon.Utils,arguments)},performRequest:(e,n,t,o=5e3)=>Kameleoon.Utils.performBeaconServerCall(e,n,t,o),querySelectorAll:function(e){return Kameleoon.Utils.querySelectorAll.apply(Kameleoon.Utils,arguments)},setInterval:(e,n=200)=>Kameleoon.Utils.setInterval(e,n,!1,!0),setTimeout:(e,n=200)=>Kameleoon.Utils.setTimeout(e,n,!0)};Object.defineProperty(this.Utils,"mouseDownEvent",{enumerable:!0,get:function(){return Kameleoon.Internals.runtime.mouseDownEvent}});Object.defineProperty(this.Utils,"touchMoveEvent",{enumerable:!0,get:function(){return Kameleoon.Internals.runtime.touchMoveEvent}});Object.defineProperty(this,"Visitor",{enumerable:!0,get:function(){try{if(!Kameleoon.Internals.runtime)return{setVisitorCode:e=>{Kameleoon.Internals.configuration.predefinedVisitorCode=e}};else return new APIVisitor}catch(e){return null}}});Object.defineProperty(this,"CurrentVisit",{enumerable:!0,get:function(){try{return new APIVisit(Kameleoon.Internals.runtime.Visitor.currentVisit)}catch(e){return null}}});Object.defineProperty(this,"React",{enumerable:!1,get:function(){return window.KameleoonAPIReact||null}})}}class Gatherer{constructor(){this.MAX_HREF_LENGTH_IN_A_REQUEST=200;this.MAX_PAGE_TITLE_LENGTH_IN_A_REQUEST=200}run(e){let t=Kameleoon.Utils.clone(Kameleoon.Internals.configuration.Gatherer);if("string"==typeof t)t=JSON.parse(Kameleoon.Utils.decodeString(t));Kameleoon.Internals.runtime.Gatherer={configuration:t,active:!0,clicks:0};this.Browser=new Browser(t.browsers);this.CustomData=new CustomData(t.customData);this.KeyPage=new KeyPage(t.keyPages);this.Language=new Language;this.OperatingSystem=new OperatingSystem(t.oss);this.Referrer=new Referrer(t.referrers);this.TimeZone=new TimeZone;Kameleoon.Internals.runtime.storedData.saveField("Gatherer","startsOfVisitForCurrentPage",0);Kameleoon.Internals.runtime.Visitor=new Visitor;e();this.track(VisitEvent_Page);this.track(VisitEvent_StaticData);VisitEvent_Activity.initialize();this.CustomData.run();Kameleoon.Internals.runtime.gathererRun=!0}startNewVisit(e,t){Kameleoon.Internals.runtime.Visitor.updateFromStoredData(!0,!0,t);this.track(VisitEvent_Page);this.track(VisitEvent_StaticData);this.CustomData.run();}track(e,t){new VisitEvent(e).track(t)}}class KameleoonEngine{constructor(){this.Analyst=new Analyst;this.API=new API;this.Gatherer=new Gatherer;this.Loader=new Loader;this.Targeting=new Targeting;this.Tracking=new Tracking;this.Utils=new Utils}}class Loader{constructor(){this.enableKameleoonEditorListener=()=>{if(!Kameleoon.Internals.runtime.editorListenerEnabled){Kameleoon.Internals.runtime.editorListenerEnabled=!0;let e=e=>{if(!e)e=window.event;Kameleoon.Loader.listenKeys.call(Kameleoon.Loader,e)};Kameleoon.Utils.addEventListener(document,"keyup",e,!1)}};this.listenKeys=e=>{if(e.shiftKey){if(113==e.keyCode&&Kameleoon.Internals.configuration.abtestingSetup){Kameleoon.Internals.runtime.editorMode=!0;Kameleoon.Analyst.loadKameleoonFull((()=>{Kameleoon.Loader.enableKameleoonEditor.apply(Kameleoon.Loader)}),!0)}if(115==e.keyCode&&(Kameleoon.Internals.runtime.simulationMode||Kameleoon.Internals.runtime.parameters.kameleoonVariationSelection))Kameleoon.Analyst.loadKameleoonFull((()=>{Kameleoon.Loader.enableSimulationPanel()}),!0)}};}}class Runtime{constructor(){this.DATA_URL=Kameleoon.Internals.configuration.DATA_URL;this.PAGE_LOADED_POLL_DELAY=250;this.PAGE_LOADING_POLL_DELAY=75;this.IDLE_DURATION=1e4;this.enableSinglePageSupport=()=>{this.singlePageSupport=!0;this.href=window.location.href;KMutationObserver.setMutationObserverSPA();Kameleoon.Utils.setInterval((()=>{const e=this.href;this.href=window.location.href;if(e!=this.href)Kameleoon.Analyst.load.apply(this,[])}),100)};this.enableDynamicRefresh=()=>{this.dynamicRefresh=!0;KMutationObserver.setMutationObserverSPA()};this.executeGlobalScript=()=>{if(Kameleoon.Internals.configuration.globalScript&&!this.globalScriptProcessed&&!this.editorMode&&!this.kameleoonSelectionIframeMode){Kameleoon.Utils.sendKameleoonCustomEvent("Internals",{type:"globalScript"});this.globalScriptProcessed=!0;Kameleoon.Utils.runProtectedScript(Kameleoon.Internals.configuration.globalScript,"kameleoonGlobalScript.js")}};this.initializePredefinedVisitorCode=()=>{if(Kameleoon.Internals.configuration.predefinedVisitorCode){const e=Kameleoon.Utils.readLocalData("kameleoonVisitorCode","COOKIE")||Kameleoon.Utils.readLocalData("kameleoonVisitorCode","LS");if(e==Kameleoon.Internals.configuration.predefinedVisitorCode)return;const t=this.storedData.Visitor.visits;if(t)t.slice(-1)[0].visitorCode=Kameleoon.Internals.configuration.predefinedVisitorCode;Kameleoon.Utils.saveVisitorCode(Kameleoon.Internals.configuration.predefinedVisitorCode);Kameleoon.Internals.configuration.experiments.forEach((e=>{Kameleoon.Utils.eraseLocalData("kameleoonExperiment-"+e.id,null,"LS")}));Kameleoon.Internals.configuration.personalizations.forEach((e=>{Kameleoon.Utils.eraseLocalData("kameleoonPersonalization-"+e.id,null,"LS")}))}};this.initializeActions=()=>{if(Kameleoon.Internals.configuration.abtestingSetup||Kameleoon.Internals.configuration.personalizationSetup){this.targetingSegments=Kameleoon.Utils.clone(Kameleoon.Internals.configuration.targetingSegments);this.variations=Kameleoon.Utils.clone(Kameleoon.Internals.configuration.variations)}if(Kameleoon.Internals.configuration.abtestingSetup)if(Kameleoon.Internals.configuration.personalizationSetup){}};this.initializeActionsAfterGatherer=()=>{};this.initializeIdleTimeListener=()=>{};this.initializeListeners=()=>{Kameleoon.Utils.domReady((()=>{this.domReady=!0;if(!0!==Kameleoon.Internals.configuration.disableEditorLaunchViaKeys)Kameleoon.Loader.enableKameleoonEditorListener();if(this.kameleoonSelectionIframeMode){const e=document.createElement("script");e.setAttribute("type","text/javascript");e.setAttribute("charset","utf-8");e.setAttribute("src","https://back-office-redesign."+Kameleoon.Internals.configuration.DOMAIN+"/get-script?type=selection");this.headNode.appendChild(e)}if(0==window.kameleoonLightIframe&&window.kameleoonIframeURL)if(Kameleoon.Internals.runtime.Gatherer.startOfVisit)Kameleoon.Utils.setTimeout((()=>{const e=document.createElement("iframe");e.src=window.kameleoonIframeURL;e.id="kameleoonExternalIframe";e.style.cssFloat="left !important";e.style.opacity="0.0 !important";e.width="0px";e.height="0px";e.onload=()=>{e.parentNode.removeChild(e)};document.head.appendChild(e)}),5e3)}));if("touchend"==this.mouseDownEvent){Kameleoon.Utils.addEventListener(document,"touchmove",(e=>{this.touchMoveEvent=!0}));Kameleoon.Utils.addEventListener(document,"touchstart",(e=>{this.touchMoveEvent=!1}))}if(!this.iframeLocalStorage)window.addEventListener("storage",(e=>{const t=null==e.key?[""]:e.key.split("-");let n=t[0];if(-1!=n.indexOf("kameleoon")){if(window.document.hasFocus())return;let o;try{o=null==e.newValue?null:JSON.parse(e.newValue).value}catch(e){return}if("kameleoonData"===n)n=this.dataKeyName;const i={};switch(n){case"kameleoonExperiment":i.type=n;const e=t[1];i.experimentId=parseInt(e);let a;if(null==o)a=null;else{const e=o.split("/")[0];a=isNaN(e)?e:parseInt(e)}i.registeredVariationId=a;break;case"kameleoonGlobalPersonalizationExposition":i.type=n;i.active=null==o?null:"true"==o.split("/")[0];break;case this.dataKeyName:case"kameleoonSimulationVisitorData":i.type=n;i.value=null==o?null:o;break;case"kameleoonLegalConsent":i.type=n;i.saveLegalConsent=null==o?null:o;break}if(null!=i.type)Kameleoon.Utils.processStorageData(i)}}),!1);this.initializeIdleTimeListener();};this.loadExternalRequests=()=>{this.Geolocation="undefined"!=typeof KGeolocation?new KGeolocation:null;this.IP="undefined"!=typeof IP?new IP:null;};this.loadAudienceSegments=()=>{if(Kameleoon.Internals.configuration.useOpportunitySegments){const e=`https://${Kameleoon.Internals.configuration.siteCode}.${Kameleoon.Internals.configuration.WIDE_DOMAIN}/audiences/segments.js`;Kameleoon.Utils.performBeaconServerCall(e,(e=>{if(4==e.readyState&&200==e.status){Kameleoon.Utils.runProtectedScript(e.responseText,"kameleoonAudiencesSegments.js");if(this.audienceSegments){this.audienceSegments.forEach((e=>{e.opportunityDetection=!0;if(null==Kameleoon.Targeting.segments[e.id]){Kameleoon.Targeting.segments[e.id]=e;this.targetingSegments.push(e)}}));Kameleoon.Targeting.processTargetingSegments(this.audienceSegments)}}}))}};this.processPageLoaded=()=>{Kameleoon.Utils.removeBlockingStyleSheet();for(let e=0,t=this.variations.length;e<t;++e)if(this["enginePollerForVariation"+this.variations[e].id]){if(Kameleoon.Internals.runtime.cantUseMutationObserver)window.clearInterval(this["enginePollerForVariation"+this.variations[e].id]);this["enginePollerForVariation"+this.variations[e].id]=null}};this.readFromStorageOrExternal=(e,t)=>{if(this.incomingStoredData)return this.incomingStoredData[e];else return Kameleoon.Utils.readLocalData(e,t,!0)};this.setup=()=>{if(Kameleoon.Internals.runtime.parameters.kameleoon)Kameleoon.Utils.domReady((()=>{Kameleoon.Loader.enableKameleoonEditor()}));const e=Kameleoon.Utils.setInterval((()=>{let t=document.getElementById("adBlockerCheck");if(null==t&&null!=document.body){t=document.createElement("div");t.id="adBlockerCheck";t.className="ad-placement";document.body.appendChild(t)}if(null!=t&&0==t.clientWidth)this.adBlocker=!0;if(null==this.adBlocker&&Kameleoon.Utils.querySelectorAll("[id^=ghostery-]").length>0)this.adBlocker=!0;if(this.adBlocker)Kameleoon.Utils.clearInterval(e)}),250);const t=Kameleoon.Utils.setTimeout((()=>{Kameleoon.Utils.clearTimeout(t);const n=document.getElementById("adBlockerCheck");if(null!=n)n.parentNode.removeChild(n);if(null==this.adBlocker){Kameleoon.Utils.clearInterval(e);this.adBlocker=!1}else Kameleoon.Gatherer.track(VisitEvent_AdBlocker)}),2e3);Kameleoon.Utils.addEventListener(window,"pageshow",(e=>{if(e.persisted)this.updateAfterPageCached()}));Kameleoon.Internals.runtime.Visitor.updateFromStoredData(!1,!1,!1);if(!Kameleoon.Internals.configuration.requestsAfterConsent)this.loadExternalRequests();KMutationObserver.setMutationObserver();Kameleoon.Analyst.loadKameleoonFull((()=>{Kameleoon.Analyst.loadSimulation()}));Kameleoon.Analyst.Goals.checkKameleoonGoals();this.loadAudienceSegments();};this.setupLocalData=e=>{Kameleoon.Utils.addEventListener(window,"message",Kameleoon.Utils.processMessageEvent,!1);if(this.iframeLocalStorage){this.externalIframe=document.getElementById("kameleoonExternalIframe")||window.kameleoonExternalIframe;this.postMessageOrigin=window.kameleoonIframeOrigin||"";this.postMessageCallbacks={};if(null==Kameleoon.Internals.configuration.externalIframeData)Kameleoon.Utils.postMessageToExternalIframe(JSON.stringify({type:"retrieve",callbackId:Kameleoon.Utils.addPostMessageCallback((t=>{this.incomingStoredData=t;e()}))}));else{this.incomingStoredData=Kameleoon.Internals.configuration.externalIframeData;e();delete Kameleoon.Internals.configuration.externalIframeData}}else{this.incomingStoredData=null;e()}};this.updateAfterPageCached=()=>{this.pageCached=!0;if(this.iframeLocalStorage)Kameleoon.Utils.postMessageToExternalIframe(JSON.stringify({type:"retrieve",callbackId:Kameleoon.Utils.addPostMessageCallback((()=>{}))}));else{const e=Kameleoon.Utils.readLocalData(Kameleoon.Internals.runtime.simulationMode?"kameleoonSimulationVisitorData":Kameleoon.Internals.runtime.dataKeyName,"LS",!0);Kameleoon.Internals.runtime.storedData.update(e);Kameleoon.Internals.runtime.Visitor.updateFromStoredData(!1,!1,!1);Kameleoon.Gatherer.track(VisitEvent_Page)}};this.getSimulationMode=()=>{const e=Kameleoon.Internals.runtime.readFromStorageOrExternal("kameleoonSimulation","LS");return e?!0:!1};this.pageStartTime=(new Date).getTime();this.dataKeyName="kameleoonData";if(Kameleoon.Internals.configuration.useMultipleSiteCodes){this.dataKeyName+="-"+Kameleoon.Internals.configuration.siteCode;Utils.LOCAL_STORAGE_OBFUSCATED_KEYS[this.dataKeyName]=!0}this.Device=new Device;this.deviceType=this.Device.type;this.parameters=Kameleoon.Utils.parseParameters();this.beforeUnloadEvent="Phone"==this.deviceType&&"Safari"==this.Device.browser?"pagehide":"beforeunload";this.headNode=document.getElementsByTagName("head")[0];this.editorMode="true"==this.parameters.kameleoon;this.proxyMode="proxy."+Kameleoon.Internals.configuration.DOMAIN===window.location.hostname;this.disableCache="true"==this.parameters.kameleoonDisableCache||this.parameters.kameleoonVariationId;this.kameleoonSelectionIframeMode="true"==this.parameters.kameleoonSelectionIframeMode;this.iframeLocalStorage=Kameleoon.Internals.configuration.useWideDomainSupport;this.useWideDomainSupport=Kameleoon.Internals.configuration.useWideDomainSupport||null!=window.kameleoonLightIframe;if(0==window.kameleoonLightIframe||null==window.kameleoonLightIframe)this.iframeLocalStorage=!1;this.mouseDownEvent="ontouchend"in document.documentElement?"touchend":"mousedown";this.addedClasses={};this.addedIDs={};this.eventListeners=[];this.listenVariations=[];this.waitingElementPresentObjects=[];this.waitingDynamicElements=[];this.variations=[];this.intervalIds={};this.targetingSegments=[];this.timeoutIds={};this.goals=Kameleoon.Utils.clone(Kameleoon.Internals.configuration.goals);this.cantUseMutationObserver="undefined"==typeof MutationObserver&&!Kameleoon.Internals.configuration.disableDomMutationObserver;this.Campaigns=new Campaigns;this.Consent=new Consent;Object.defineProperty(this,"experiments",{get:()=>Kameleoon.Internals.runtime.Campaigns.obtainCampaignsList("experiments")});Object.defineProperty(this,"personalizations",{get:()=>Kameleoon.Internals.runtime.Campaigns.obtainCampaignsList("personalizations")})}clear(){this.eventListeners.forEach((e=>{let t;if("window"==e.elementKey||"document"==e.elementKey)t="window"==e.elementKey?window:document;else{t=document.querySelector(`[kameleoonListener-${e.elementKey}=true]`);if(t)t.removeAttribute(`kameleoonListener-${e.elementKey}`)}if(t)t.removeEventListener(e.eventType,e.actionFunction,e.useCapture)}));this.waitingDynamicElements.forEach((e=>{Kameleoon.Utils.querySelectorAll(`[${e.attribute}=true]`).forEach((t=>{t.removeAttribute(e.attribute)}))}));for(const e in this.timeoutIds)Kameleoon.Utils.clearTimeout(parseInt(e));for(const e in this.intervalIds)Kameleoon.Utils.clearInterval(parseInt(e));if(this.RequestManager)this.RequestManager.processRequests();if(this.storedData)this.storedData.save(!0);if(null!=this.mutationObserver)this.mutationObserver.disconnect();if(null!=this.mutationObserverSpa)this.mutationObserverSpa.disconnect();let e=Kameleoon.Utils.querySelectorAll("[id^='kameleoonElement'], [id*='kameleoonScenarioLayerBase'], [id^='kameleoonStyleSheet'], [class*='kameleoonWidget']");for(let t=0;t<e.length;++t)e[t].parentNode.removeChild(e[t]);e=Kameleoon.Utils.querySelectorAll("[id^='kameleoonId'], .kameleoonOverlay");for(let t=0;t<e.length;++t)e[t].removeAttribute("id");e=Kameleoon.Utils.querySelectorAll("[class^='kameleoonClass']");for(let t=0;t<e.length;++t)e[t].removeAttribute("class");if(Kameleoon.Internals.runtime.storedData)Kameleoon.Internals.runtime.storedData.save(!0);Kameleoon.API.Events.triggered=[]}run(){this.running=!0;Kameleoon.Utils.removeBlockingStyleSheet();this.setupLocalData((()=>{this.simulationMode=this.getSimulationMode();this.storedData=new StoredData(this.incomingStoredData);Kameleoon.Internals.runtime.Consent.setup();this.initializePredefinedVisitorCode();this.initializeActions();Kameleoon.Gatherer.run((()=>{this.RequestManager=new RequestManager}));this.initializeActionsAfterGatherer();this.executeGlobalScript();window.kameleoonQueue=new CommandQueue(window.kameleoonQueue);Kameleoon.Utils.sendKameleoonCustomEvent.call(window,"Started",{newVisitorCode:1==Kameleoon.Internals.runtime.Visitor.visits.length});this.initializeListeners();this.setup();this.setupAfterLocalDataRetrieval=!0}))}}class Utils{constructor(){this.events=[];this.addParameterToURL=(e,t,n)=>{if(n)return e+(-1==e.indexOf("#")?"#":"&")+t;let o="";if(-1!=e.indexOf("#")){o=e.substr(e.indexOf("#"));e=e.substr(0,e.indexOf("#"))}e+=(-1==e.indexOf("?")?"?":"&")+t+o;return e};this.computeCurrentPageAbsoluteURLNoProxyMode=function(){let e=Kameleoon.Internals.runtime;if(null==e.currentPageAbsoluteURLNoProxyMode){if(e.proxyMode){let t=e.parameters.kameleoonExperimentId||e.parameters["kameleoon-experiment-id"];if(null!=t){let n=e.Campaigns.obtainCampaign(t,"experiment");if(n)e.currentPageAbsoluteURLNoProxyMode=n.baseURL}}if(null==e.currentPageAbsoluteURLNoProxyMode)e.currentPageAbsoluteURLNoProxyMode=window.location.href}return e.currentPageAbsoluteURLNoProxyMode};this.computeCurrentPageCanonicalURL=()=>{if(null==Kameleoon.Internals.runtime.currentPageCanonicalURL){let e=this.querySelectorAll('link[rel="canonical"]');if(e.length>0)Kameleoon.Internals.runtime.currentPageCanonicalURL=e[0].href}return Kameleoon.Internals.runtime.currentPageCanonicalURL};this.computeCurrentPageCleanRelativeURL=()=>{if(null==Kameleoon.Internals.runtime.currentPageCleanRelativeURL)Kameleoon.Internals.runtime.currentPageCleanRelativeURL=this.computeRelativeURL(this.computeCurrentPageCleanAbsoluteURL());return Kameleoon.Internals.runtime.currentPageCleanRelativeURL};this.computeIfSuffix=(e,t)=>{let n=e.length-t.length;let o=e.lastIndexOf(t,n);return o>=0&&o==n};this.computeRelativeURL=e=>{let t=document.createElement("a");t.href=e;return t.pathname+t.search+t.hash};this.computeStringSha256=e=>{let t=1,n,o=[],a=[];while(++t<18)for(n=t*t;n<312;n+=t)o[n]=1;function r(e,t){return Math.pow(e,1/t)%1*4294967296|0}for(t=1,n=0;t<313;)if(!o[++t]){a[n]=r(t,2);o[n++]=r(t,3)}function l(e,t){return e>>>t|e<<32-t}let i=a.slice(t=0),s=this.encodeUTF8(e),m=[],u=s.length,c=[],d,f,h;for(;t<u;)c[t>>2]|=(255&s.charCodeAt(t))<<8*(3-t++%4);u*=8;c[u>>5]|=128<<24-u%32;c[h=u+64>>5|15]=u;for(t=0;t<h;t+=16){d=i.slice(n=0,8);for(;n<64;d[4]+=f){if(n<16)m[n]=c[n+t];else m[n]=(l(f=m[n-2],17)^l(f,19)^f>>>10)+(0|m[n-7])+(l(f=m[n-15],7)^l(f,18)^f>>>3)+(0|m[n-16]);let e;d.unshift((f=(d.pop()+(l(e=d[4],6)^l(e,11)^l(e,25))+((e&d[5]^~e&d[6])+o[n])|0)+(0|m[n++]))+(l(u=d[0],2)^l(u,13)^l(u,22))+(u&d[1]^d[1]&d[2]^d[2]&u))}for(n=8;n--;)i[n]=d[n]+i[n]}for(s="";n<63;)s+=(i[++n>>3]>>4*(7-n%8)&15).toString(16);return s};this.computeURLNoKameleoonParameters=e=>{let t=!1;for(let n in Kameleoon.Internals.runtime.parameters)if(-1!=n.indexOf("kameleoon")){t=!0;e=e.replace(new RegExp(n+"="+Kameleoon.Internals.runtime.parameters[n]+"&?"),"")}return t?e.replace(/\?$/,""):e};this.computeURLRegExpNoKameleoonParameters=e=>e?e.replace(/(\\\?|&|#)kameleoon[^&#()]*/g,""):null;this.createLocalData=(e,t,n,o,a,r,l,i)=>{let s="COOKIE"!=a;let m=(new Date).getTime();if(!i&&!Kameleoon.Internals.runtime.Consent.hasGlobalConsent()){let i=s?"LS":"COOKIE";if(null==Kameleoon.Internals.runtime.localDataMap)Kameleoon.Internals.runtime.localDataMap={};if(null==Kameleoon.Internals.runtime.localDataMap[i])Kameleoon.Internals.runtime.localDataMap[i]={};Kameleoon.Internals.runtime.localDataMap[i][e]={name:e,value:t,days:n,domain:o,forceLocalAccess:a,jsonFormat:r,creationTime:m};if(s)l&&l();return}if(s){let o=m+24*n*60*60*1e3;if(Kameleoon.Internals.runtime.iframeLocalStorage)this.postMessageToExternalIframe(JSON.stringify({type:"set",key:e,data:{value:Utils.LOCAL_STORAGE_OBFUSCATED_KEYS[e]&&this.obfuscateString(JSON.stringify(t))||t,expirationDate:o},callbackId:this.addPostMessageCallback(l)}));else{try{localStorage.setItem(e,JSON.stringify({value:Utils.LOCAL_STORAGE_OBFUSCATED_KEYS[e]&&this.obfuscateString(JSON.stringify(t))||t,expirationDate:o}))}catch(e){}l&&l()}}else{let a="";let l=r?JSON.stringify(t):t;if(n){let e=new Date(m+24*n*60*60*1e3);a="; expires="+e.toUTCString()}if("CURRENT_HOST"!=o){o=o||Kameleoon.Internals.configuration.customCookieDomainName||this.obtainCurrentRootDomain();a+="; domain="+o}const i=Kameleoon.Internals.configuration.useSecureCookie?"; Secure":"";document.cookie=e+"="+l+a+"; path=/; SameSite=Lax"+i}};this.decodeString=e=>{let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n="";let o,a,r;let l,i,s,m;let u=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(u<e.length){l=t.indexOf(e.charAt(u++));i=t.indexOf(e.charAt(u++));s=t.indexOf(e.charAt(u++));m=t.indexOf(e.charAt(u++));o=l<<2|i>>4;a=(15&i)<<4|s>>2;r=(3&s)<<6|m;n+=String.fromCharCode(o);if(64!=s)n+=String.fromCharCode(a);if(64!=m)n+=String.fromCharCode(r)}n=this.decodeUTF8(n);return n};this.decodeUTF8=e=>{let t="";let n=0;let o=0,a=0,r;while(n<e.length){o=e.charCodeAt(n);if(o<128){t+=String.fromCharCode(o);n++}else if(o>191&&o<224){a=e.charCodeAt(n+1);t+=String.fromCharCode((31&o)<<6|63&a);n+=2}else{a=e.charCodeAt(n+1);r=e.charCodeAt(n+2);t+=String.fromCharCode((15&o)<<12|(63&a)<<6|63&r);n+=3}}return t};this.domReady=e=>{if("complete"==document.readyState||"interactive"==document.readyState)return e();else{let t=!1;this.addEventListener(document,"DOMContentLoaded",(()=>{if(t)return;t=!0;e()}),!1);this.addEventListener(window,"load",(()=>{if(t)return;t=!0;e()}),!1)}};this.encodeString=e=>{let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n="";let o,a,r,l,i,s,m;let u=0;e=this.encodeUTF8(e);while(u<e.length){o=e.charCodeAt(u++);a=e.charCodeAt(u++);r=e.charCodeAt(u++);l=o>>2;i=(3&o)<<4|a>>4;s=(15&a)<<2|r>>6;m=63&r;if(isNaN(a))s=m=64;else if(isNaN(r))m=64;n=n+t.charAt(l)+t.charAt(i)+t.charAt(s)+t.charAt(m)}return n};this.encodeUTF8=e=>{e=e.replace(/\r\n/g,"\n");let t="";for(let n=0;n<e.length;n++){let o=e.charCodeAt(n);if(o<128)t+=String.fromCharCode(o);else if(o>127&&o<2048){t+=String.fromCharCode(o>>6|192);t+=String.fromCharCode(63&o|128)}else{t+=String.fromCharCode(o>>12|224);t+=String.fromCharCode(o>>6&63|128);t+=String.fromCharCode(63&o|128)}}return t};this.eraseLocalData=(e,t,n)=>{let o="COOKIE"!=n;let a=Kameleoon.Internals.runtime.localDataMap;let r=o?"LS":"COOKIE";if(null!=a&&null!=a[r]&&null!=a[r][e])delete a[r][e];if(o)if(Kameleoon.Internals.runtime.iframeLocalStorage)this.postMessageToExternalIframe(JSON.stringify({type:"remove",key:e,callbackId:this.addPostMessageCallback(null)}));else localStorage.removeItem(e);else this.createLocalData(e,"",-1,t,"COOKIE",!1,null,!0)};this.forceNoFlicker=e=>{let t=document.createElement("style");t.setAttribute("id","kameleoonPageLoading");t.setAttribute("rel","stylesheet");t.setAttribute("type","text/css");t.setAttribute("media","screen");let n=e+" { visibility: hidden !important; background-image: none !important; }";t.appendChild(document.createTextNode(n));Kameleoon.Internals.runtime.headNode.appendChild(t)};this.getLocale=e=>{let t=Kameleoon.Gatherer.Language.obtainLocaleTag();if("fr-FR"==t)t="fr";if("en-US"==t)t="en";if(e&&(!t||"fr"!=t))t="en";return t.substring(0,2)};this.obtainComputedStyle=e=>{if(window.getComputedStyle)return getComputedStyle(e,"");return null};this.obtainCurrentRootDomain=()=>{if(null==Kameleoon.Internals.runtime.currentRootDomain){let e=window.location.hostname.split(".");let t="";const n="testRootDomain";const o="_detectRootDomain";for(let a=0,r=e.length;a<r;a++){if(a>0)t="."+t;t=e[r-a-1]+t;if(0==t.length)continue;this.createLocalData(o,n,1,t,"COOKIE",!1,void 0,!0);const l=this.readLocalData(o,"COOKIE",!1);if(l){this.eraseLocalData(o,t,"COOKIE");Kameleoon.Internals.runtime.currentRootDomain=t;break}}}return Kameleoon.Internals.runtime.currentRootDomain};this.obtainRandomString=(e,t=Analyst.CODE_ALPHABET)=>{let n=t.length;let o="";for(let a=0;a<e;++a){let e=Math.floor(Math.random()*n);o+=t.substring(e,e+1)}return o};this.parseHostName=e=>{let t=document.createElement("a");t.href=e;return t.hostname};this.processRedirect=(e,t)=>{if(window.location.href!=e){t=t||Kameleoon.Analyst.Actions.currentAction;if(Kameleoon.Internals.runtime.gathererRun&&1==Kameleoon.Internals.runtime.Visitor.currentVisit.obtainPageNumberViews()){}let o=document.createElement("a");o.href=e;if(!Kameleoon.Internals.runtime.useWideDomainSupport&&-1==window.location.href.indexOf(o.protocol+"//"+o.hostname)){if(t)e=Kameleoon.Utils.addParameterToURL(e,"kameleoonRedirect-"+t.id+"="+t.associatedVariation.id,!0)}else if(t)Kameleoon.Utils.createLocalData("kameleoonRedirect-"+t.id,t.associatedVariation.id,1,null,null,!1,null,!0);if(window.location.href!=e){Kameleoon.Utils.forceNoFlicker("*");Kameleoon.Utils.createLocalData("kameleoonReferrer",Kameleoon.Gatherer.Referrer.obtain(),1/24,null,"COOKIE",!1);window.location.replace(e)}}};this.processStorageData=e=>{if(Kameleoon.Internals.runtime.setupAfterLocalDataRetrieval)switch(e.type){case"kameleoonExperiment":for(let t in Kameleoon.Internals.runtime.Campaigns.experiments){let n=Kameleoon.Internals.runtime.Campaigns.experiments[t];if(e.experimentId==n.id){n.registeredVariationId=e.registeredVariationId;break}}break;case"kameleoonGlobalPersonalizationExposition":Kameleoon.Internals.runtime.personalizationsActive=e.active;break;case Kameleoon.Internals.runtime.dataKeyName:case"kameleoonSimulationVisitorData":if(e.type==Kameleoon.Internals.runtime.dataKeyName&&!Kameleoon.Internals.runtime.simulationMode||"kameleoonSimulationVisitorData"==e.type&&Kameleoon.Internals.runtime.simulationMode){if(Kameleoon.Internals.runtime.pageCached)Kameleoon.Internals.runtime.storedData.update(Kameleoon.Utils.readLocalData(e.type,"LS",!0));else Kameleoon.Internals.runtime.storedData.update(JSON.parse(Kameleoon.Utils.unobfuscateString(e.value)));Kameleoon.Internals.runtime.Visitor.updateFromStoredData(!1,!1,!1)}break;case"kameleoonLegalConsent":if(e.saveLegalConsent){let t=e=>e?"enable":"disable";if(null!=e.saveLegalConsent.AB_TESTING){let n=t(e.saveLegalConsent.AB_TESTING);Kameleoon.Internals.runtime.Consent[n]("AB_TESTING",!0)}if(null!=e.saveLegalConsent.PERSONALIZATION){let n=t(e.saveLegalConsent.PERSONALIZATION);Kameleoon.Internals.runtime.Consent[n]("PERSONALIZATION",!0)}}break}};this.querySelectorAll=(e,t)=>{Kameleoon.Internals.runtime.querySelectorAllHasError=!1;let n=!1,o,a=[],r=[];if(null==t)t=document;let l=e.match(/#([0-9]+.*)(?: |$)/);if(l){let t=e.charAt(1);e=e.replace("#"+t,"#\\3"+t+" ")}if(""!==e){if(-1!==e.indexOf("[")&&-1===e.indexOf("']")&&-1===e.indexOf('"]')){let t=e.split(/(?=\.)|(?=#)|(?=\[)/),n,o,a;t.forEach((function(t){if("["===t[0]&&-1===t.indexOf("']")&&-1===e.indexOf('"]')&&-1!==e.indexOf("=")){n=t.split(/=(.+)?/);o=n[1];o=o.substring(0,o.length-1);a=n[0]+"='"+o+"']";e=e.replace(t,a)}}))}if(-1!==e.indexOf(":contains")){n=!0;o=this.treatContainsSelector(e);e=o.newSelector}if(t&&t.querySelectorAll)if(-1!==e.indexOf(":eq"))a=this.treatEqSelector(e,t);else try{a=t.querySelectorAll(e)}catch(e){Kameleoon.Internals.runtime.querySelectorAllHasError=!0;a=[]}for(let e=0,t=a.length;e<t;++e)if(n){if(o.check(o.containText,a[e]))r.push(a[e])}else r.push(a[e])}return r};this.readLocalData=(e,t,n)=>{let o="COOKIE"!=t;let a=(new Date).getTime();try{if(!Kameleoon.Internals.runtime.Consent.hasGlobalConsent()){let t=Kameleoon.Internals.runtime.localDataMap;let n=o?"LS":"COOKIE";if(null!=t&&null!=t[n]&&null!=t[n][e]){let o=t[n][e];if(a-24*o.days*60*60*1e3>=o.creationTime)delete t[n][e];else return o.value}}if(o){let t;t=localStorage&&localStorage.getItem(e);if(!t)return null;t=JSON.parse(t);if(Utils.LOCAL_STORAGE_OBFUSCATED_KEYS[e])t.value=JSON.parse(this.unobfuscateString(t.value));if(a>(t.date||t.expirationDate)){localStorage.removeItem(e);return null}return t.value}else{let t=null;let o=document.cookie.split(";");for(let a=0,r=o.length;a<r;++a){let r=o[a];let l=r.indexOf("=");if(r.substring(0,l).trim()==e){let e=r.substring(l+1);t=n&&JSON.parse(e)||e;break}}return t}}catch(e){}return null};this.runProtectedFunction=(e,t)=>{try{e()}catch(e){if(t)console.log(e);else Kameleoon.Utils.Logger.send(e,"kameleoon.js");if(Kameleoon.Internals.runtime&&t)Kameleoon.Internals.runtime.processPageLoaded()}};this.runProtectedScript=(e,t,n)=>{if(n)return n();if(e){let n=null;try{let o=t?"//# sourceURL="+t:"";n=eval.call(window,"(function () {\n"+e+"\n})();"+o)}catch(e){n=null;console.log(e)}return n}return null};this.saveVisitorCode=(e,t=!0)=>{if(Kameleoon.Internals.configuration.useWideDomainSupport||Kameleoon.Internals.configuration.useVisitorCodeInLocalStorage)Kameleoon.Utils.createLocalData("kameleoonVisitorCode",e,Utils.MAX_STORAGE_DAYS,null,"LS");if(t)Kameleoon.Utils.createLocalData("kameleoonVisitorCode",e,Utils.MAX_STORAGE_DAYS,null,"COOKIE")};this.seededRandom=(e,t)=>{let n;if(t){n=Kameleoon.Utils.computeStringSha256(e);return parseInt(n,16)/Math.pow(2,256)}n=this.computeStringHash(e);n=(9301*Math.abs(n)+49297)%233280;return n/233280};this.treatEqSelector=(e,t)=>{if(void 0===e)return null;let n=e.split(/\:eq\([0-9]+\)/g);let o=e.match(/(?!\:eq\()[0-9]+/g)||[];let a=null==t?document:t;for(let t=0;t<n.length;++t){n[t]=n[t].trim();if(">"===n[t].charAt(0))n[t]=n[t].substring(1,e.length).trim();if(null==a||""==n[t].trim())break;if(t>o.length-1)a=a.querySelectorAll(n[t]);else a=a.querySelectorAll(n[t])[o[t]]}if(null==a)return[];if(void 0==a.length)a=[a];let r=Kameleoon.Utils.querySelectorAll(e.replace(/\:eq\([0-9]+\)/g,""));let l=[];for(let e=0;e<r.length;++e)for(let t=0;t<a.length;++t)if(r[e]===a[t]){l.push(a[t]);break}return l};this.Logger=new Logger;this.bowser=window.kbowser||window.bowser}addEventListener(e,t,n,o,a){let r;if(e==window)r="window";else if(e==document)r="document";else{r=Kameleoon.Utils.obtainRandomString(4);e.setAttribute(`kameleoonListener-${r}`,!0)}let l=n;if(a)e.addEventListener(t,l,o);else{l=function(e){Kameleoon.Utils.runProtectedFunction((function(){n(e)}))};e.addEventListener(t,l,o)}Kameleoon.Internals.runtime.eventListeners.push({elementKey:r,eventType:t,actionFunction:l,useCapture:o})}addPostMessageCallback(e){let t=Math.random().toString();Kameleoon.Internals.runtime.postMessageCallbacks[t]=e;return t}addCSSStyleSheet(e,t,n){if(!e)return;let o=n?n:document;let a="kameleoonStyleSheet"+(t?"-"+t.id:"");let r=n?n.getElementById(a):null;let l="";if(r){l=r.textContent;r.parentNode.removeChild(r)}let i=o.createElement("style");i.className="KameleoonStyleSheet";i.setAttribute("id",a);i.setAttribute("rel","stylesheet");i.setAttribute("type","text/css");i.setAttribute("media","screen");let s=l+e;if(i.styleSheet)i.styleSheet.cssText=s;else i.appendChild(document.createTextNode(s));if(n)o.getElementsByTagName("head")[0].appendChild(i,o.getElementsByTagName("head")[0].firstChild);else Kameleoon.Internals.runtime.headNode.appendChild(i);if(t)t.loadedCSSStyleSheet=i}applyVariation(e){new Variation(e).process()}clearInterval(e){delete Kameleoon.Internals.runtime.intervalIds[e];window.clearInterval(e)}clearTimeout(e){delete Kameleoon.Internals.runtime.timeoutIds[e];window.clearTimeout(e)}clone(e){return JSON.parse(JSON.stringify(e))}computeCurrentPageCleanAbsoluteURL(){if(null==Kameleoon.Internals.runtime.currentPageCleanAbsoluteURL){Kameleoon.Internals.runtime.currentPageCleanAbsoluteURL=this.computeURLNoKameleoonParameters(this.computeCurrentPageAbsoluteURLNoProxyMode());try{Kameleoon.Internals.runtime.currentPageCleanAbsoluteURL=decodeURIComponent(Kameleoon.Internals.runtime.currentPageCleanAbsoluteURL)}catch(e){}}return Kameleoon.Internals.runtime.currentPageCleanAbsoluteURL}computeStringHash(e,t){e=t?this.computeStringSha256(e):e;let n=0;for(let t=0;t<e.length;++t){n=(n<<5)-n+e.charCodeAt(t);n&=n}return n}secureSessionStorage(e,t,n){try{return window.sessionStorage[e](t,n)}catch(e){return null}}flatten(...e){let t=[];for(let e=0;e<arguments.length;e++)if(arguments[e]instanceof Array)t.push.apply(t,Kameleoon.Utils.flatten.apply(this,arguments[e]));else t.push(arguments[e]);return t}obfuscateString(e){let t="";for(let n=0,o=e.length;n<o;n+=1){let o=e[n];if("’"==o)o="'";t+=String.fromCharCode(o.charCodeAt(0)+16)}return t}parseParameters(){let e={};let t=window.location.hash.substring(1).replace(/\?/g,"&");let n=window.location.search.substring(1);if(n||t){let o=(n?n.split("&"):[]).concat(t?t.split("&"):[]);o.forEach((t=>{let n=t.split("=");try{e[decodeURIComponent(n[0])]=n[1]?decodeURIComponent(n[1]):null}catch(t){e[unescape(n[0])]=n[1]?unescape(n[1]):null}}))}return e}performBeaconServerCall(e,t,n,o){let a=new XMLHttpRequest;a.open("GET",e,!0);if(t)a.onreadystatechange=function(e){t.bind(a)(e.target)};if(n){a.onerror=function(e){n.bind(a)(e.target)};a.ontimeout=function(e){n.bind(a)(e.target)}}a.timeout=o||15*60*1e3;a.send()}postMessageToExternalIframe(e){if(!Kameleoon.Internals.runtime.externalIframe||!Kameleoon.Internals.runtime.externalIframe.contentWindow){if(window.kameleoonIframeURL){let t=document.createElement("iframe");t.src=window.kameleoonIframeURL;t.id="kameleoonExternalIframe";t.style.cssFloat="left !important";t.style.height="0px !important";t.style.opacity="0.0 !important";t.style.width="0px !important";t.onload=()=>{Kameleoon.Internals.runtime.externalIframe=t;Kameleoon.Internals.runtime.externalIframe.contentWindow.postMessage("kameleoon"+e,"*")};document.head.appendChild(t)}}else Kameleoon.Internals.runtime.externalIframe.contentWindow.postMessage("kameleoon"+e,"*")}processMessageEvent(e){if("string"!==typeof e.data)return;if("obtainTagCommanderVariableNames"==e.data){let t=[];if(window.tc_vars)for(let e in window.tc_vars)t.push(e);if(!(e.source instanceof MessagePort)&&!(e.source instanceof ServiceWorker))e.source.postMessage("tagCommanderVariableNames"+JSON.stringify(t),e.origin);return}if(0==e.data.indexOf("checkKameleoonScriptPresent")){if("https://back-office."+Kameleoon.Internals.configuration.DOMAIN==e.origin){let t="";let n=e.data.replace("checkKameleoonScriptPresent","");Kameleoon.Utils.runProtectedScript(n);if(!(e.source instanceof MessagePort)&&!(e.source instanceof ServiceWorker))e.source.postMessage(t,e.origin)}return}if(Kameleoon.Internals.runtime.iframeLocalStorage&&Kameleoon.Internals.runtime.postMessageOrigin==e.origin)try{let t=JSON.parse(e.data);if(t.kameleoonMessage){if(t.callbackId){let e=Kameleoon.Internals.runtime.postMessageCallbacks[t.callbackId];delete Kameleoon.Internals.runtime.postMessageCallbacks[t.callbackId];e&&e(t.data)}if(null!=t.type)Kameleoon.Utils.processStorageData(t)}}catch(e){}}removeBlockingStyleSheet(){let e=document.getElementById("kameleoonPageLoading");if(e&&e.parentNode)e.parentNode.removeChild(e)}removeCSSStyleSheet(e){if(e.loadedCSSStyleSheet){var t=e.loadedCSSStyleSheet.id.replace("kameleoonStyleSheet-","");if(-1==t.indexOf(",")){Kameleoon.Internals.runtime.headNode.removeChild(e.loadedCSSStyleSheet);e.loadedCSSStyleSheet=null}else e.loadedCSSStyleSheet.id="kameleoonStyleSheet-"+t.replace(new RegExp(e.id+",?"),"")}}sendKameleoonCustomEvent(e,t,n){try{let o=document.createEvent("CustomEvent");t.time=(new Date).getTime();o.initCustomEvent("Kameleoon::"+e,!1,!1,t);window.dispatchEvent(o);if(sessionStorage.getItem("kameleoonLightExtension")||Kameleoon.Internals.runtime.parameters.kameleoonLightExtension){t.type=n?n:t.type;window.kameleoonEvents=window.kameleoonEvents||[];window.kameleoonEvents.push(t)}}catch(e){}}setInterval(e,t,n,o){let a=window.setInterval((function(){Kameleoon.Utils.runProtectedFunction((function(){e()}),o)}),t);Kameleoon.Internals.runtime.intervalIds[a]=!0;if(n)e();return a}setTimeout(e,t,n){let o=window.setTimeout((function(){Kameleoon.Utils.runProtectedFunction((function(){e()}),n)}),t);Kameleoon.Internals.runtime.timeoutIds[o]=!0;return o}testEmptyMap(e){return 0==Object.keys(e).length}parseObjectToUrlParams(e){return Object.entries(e).map((e=>e[0]+"="+e[1])).join("&")}treatContainsSelector(e){let t={},n;function o(e,t){let n=!1;if(t.textContent&&-1!==t.textContent.indexOf(e))n=!0;return n}n=e.match(/:contains\(['"]([\s\S]+)['"]\)/);t.containText=n[1];t.newSelector=e.replace(n[0],"");if(""===t.newSelector)t.newSelector="*";t.check=o;return t}unobfuscateString(e){let t="";for(let n=0,o=e.length;n<o;n+=1)t+=String.fromCharCode(e[n].charCodeAt(0)-16);return t}}Utils.LOCAL_STORAGE_OBFUSCATED_KEYS={kameleoonData:!0,kameleoonSimulationVisitorData:!0};Utils.MAX_STORAGE_DAYS=365;class Browser{constructor(e){this.browsers=e}obtain(){let e=Kameleoon.Internals.runtime.Device.browser;if("Internet Explorer"==e||"Microsoft Edge"==e)e="Explorer";return e}obtainIndex(){let e=this.obtain()||"";let r=e.toUpperCase();for(let e in this.browsers)if(this.browsers[e].name.toUpperCase()==r)return parseInt(e);return null}}class CustomData{constructor(t){this.CUSTOM_DATA_CUTOFF=3*1e3;this.CUSTOM_DATA_INTERVAL=3*1e3;this.CUSTOM_DATA_RETRY_DELAY_BEFORE_CUT_OFF=100;this.MAX_INTERVAL_API_VISIT_REQUEST=15*60*1e3;this.MAX_NUMBER_REQUESTS_TO_API_VISIT=3;this.inheritVisitorScopeAndTrackVisitorDataFromServer=()=>{if(Kameleoon.Internals.runtime.Visitor.visits.length>1){const t=Kameleoon.Internals.runtime.Visitor.currentVisit.customData;const e=Kameleoon.Internals.runtime.Visitor.visits[Kameleoon.Internals.runtime.Visitor.visits.length-2].customData;for(const i in this.customData){const a=this.customData[i].scope;if("VISITOR"==a&&null==t[i]){const t=e[i];if(null!=t)this.register(parseInt(i),{value:t,overwrite:!0},!0)}}Kameleoon.Internals.runtime.Visitor.saveToStoredData()}};this.register=(t,e,i)=>{const a=this.customData[t];if(a){let n={};const s=e.value;if(null==s)return;const r=e.overwrite;if(i)n=s;else if(s instanceof Array){for(let t=0,e=s.length;t<e;++t)if(null!=s[t]&&(s[t].toString().length<=VisitEvent_CustomData.MAX_SUM_CUSTOM_DATA_VALUES_LENGTHES_IN_A_REQUEST||a.localOnly))n[s[t]]=1}else if(s.toString().length<=VisitEvent_CustomData.MAX_SUM_CUSTOM_DATA_VALUES_LENGTHES_IN_A_REQUEST||a.localOnly)n[s]=1;const o="LIST"==a.type||"COUNT_LIST"==a.type?r:!0;if(o||!Kameleoon.Utils.testEmptyMap(n)){Kameleoon.Utils.sendKameleoonCustomEvent.call(window,"CustomDataSet",{name:a.name,value:s});Kameleoon.Utils.sendKameleoonCustomEvent("Internals",{type:"customData/set",name:a.name,value:s});Kameleoon.Gatherer.track(VisitEvent_CustomData,{index:t,customData:a,overwrite:o,overwriteDefault:r,valueToAdd:n,value:s})}}};this.customDataVisitsRequest=t=>{};this.run=()=>{Kameleoon.Internals.runtime.Visitor.currentVisit.clearCustomDataPage();Kameleoon.Utils.clearInterval(this.intervalId);if(Kameleoon.Internals.runtime.Gatherer.startOfVisit)this.inheritVisitorScopeAndTrackVisitorDataFromServer();this.firstTimeCheck=(new Date).getTime();this.intervalId=Kameleoon.Utils.setInterval(this.obtain.bind(this),this.CUSTOM_DATA_RETRY_DELAY_BEFORE_CUT_OFF,!0);Kameleoon.Utils.setTimeout((()=>{Kameleoon.Utils.clearInterval(this.intervalId)}),this.CUSTOM_DATA_CUTOFF);Kameleoon.Utils.setInterval(this.obtain.bind(this),this.CUSTOM_DATA_INTERVAL,!1)};this.customData=t;Kameleoon.Internals.runtime.enableHistoryReconciliation=!1;for(const e in t)if(t[e].mappingIdentifier){Kameleoon.Internals.runtime.enableHistoryReconciliation=!0;break}}parseNumberValue(t,e){switch(t){case-2:return"true"===e;case-1:return e;default:return parseFloat(e)}}obtainParsedValue(t,e){const i=this.customData[t];switch(i.type){case"COUNT_LIST":const t=[];for(const i in e)t.push({value:i,count:e[i]});return t;case"LIST":const a=[];for(const t in e)a.push(t);return a;default:return this.parseNumberValue(i.format,Object.keys(e)[0])}}obtain(){for(const t in this.customData)if(!this.customData[t].treated){const e=parseInt(t);const i=this.obtainValueMap(e,this.customData[t]);if(i)this.register(e,i)}}obtainValueFromPath(t,e){return t.match(/[^'\]\[\.\"]+/gi).reduce(((t,e)=>t&&t[e]),e)}obtainValueMap(t,e){let i=null;if(null!=e&&!e.disabled)switch(e.method.toUpperCase()){case"GTM":if(window.dataLayer&&e.variableName)for(let t=0,a=window.dataLayer.length;t<a;++t){const a=this.obtainValueFromPath(e.variableName,window.dataLayer[t]);if(null!=a){i={value:a,overwrite:!1};break}}break;case"TC":if(window.tc_vars&&e.variableName){let t=this.obtainValueFromPath(e.variableName,window.tc_vars);if("string"==typeof t&&0==t.length)t=null;if(null!=t){i={value:t,overwrite:!1};break}}break;case"TEALIUM":if(window.utag&&window.utag.data&&e.variableName){let t=this.obtainValueFromPath(e.variableName,window.utag.data);if("string"==typeof t&&0==t.length)t=null;if(null!=t){i={value:t,overwrite:!1};break}}break;case"CUSTOM_CODE":i=Kameleoon.Utils.runProtectedScript(e.customEvalCode,"kameleoonCustomDataScript-"+t+".js");break;default:break}if(null!=i){e.treated=!0;const a=Kameleoon.Internals.runtime.Visitor.currentVisit.customData[t];const n=i.value;if(null!=n){const t=e.type;if("LIST"==t||"COUNT_LIST"==t||null==a||Object.keys(a)[0]!=n.toString()||Kameleoon.Internals.runtime.enableHistoryReconciliation&&e.mappingIdentifier&&null==Kameleoon.Internals.runtime.storedData.obtainField("Gatherer","visitsRequestSuccess"))return i}}return null}}class KeyPage{constructor(e){this.keyPages=e}obtainIndexes(){let e=[];for(let t in this.keyPages){let s=new RegExp(this.keyPages[t].relativeURLRegExp);if(s.test(Kameleoon.Utils.computeCurrentPageCleanAbsoluteURL())||s.test(Kameleoon.Utils.computeCurrentPageCleanRelativeURL()))e.push(parseInt(t))}if(0==e.length)e.push(null);return e}}class Language{constructor(){this.DEFAULT_LOCALE_LANGUAGE_TAG="en"}obtainLocaleTag(){let a=null;if(navigator&&navigator.language)a=navigator.language;return a?a:this.DEFAULT_LOCALE_LANGUAGE_TAG}}class OperatingSystem{constructor(e){this.oss=e}obtainIndex(){let e=this.obtain()||"";let s=e.toUpperCase();for(let e in this.oss)if(this.oss[e].name.toUpperCase()==s)return parseInt(e);return null}obtain(){let e=Kameleoon.Utils.bowser.parse(navigator.userAgent);switch(e.os.name){case"Windows Phone":case"iOS":case"Android":case"Linux":case"Windows":return e.os.name;case"macOS":return"Tablet"==Kameleoon.Internals.runtime.Device.type?"iOS":"Mac";default:return"Other"}}}class Referrer{constructor(e){this.referrers=e;this.referrer=document.referrer;let t=Kameleoon.Utils.readLocalData("kameleoonReferrer","COOKIE");if(t){this.referrer=t;Kameleoon.Utils.eraseLocalData("kameleoonReferrer",null,"COOKIE")}}obtainCorrected(e){switch(this.obtainType(e)){case 0:case 1:return null;default:return this.obtain()}}obtain(){return this.referrer}obtainDetectionMatches(e){let t=this.obtainDetectionPartMatches(e.method,e.parameters);if(e.and)t=t&&this.obtainDetectionPartMatches(e.andMethod,e.andParameters);return t}obtainDetectionPartMatches(e,t){switch(e.toUpperCase()){case"REFERRER_REGEX":return new RegExp(t).test(this.obtain());case"URL_REGEX":let e=new RegExp(t);return e.test(Kameleoon.Utils.computeCurrentPageCleanAbsoluteURL())||e.test(Kameleoon.Utils.computeCurrentPageCleanRelativeURL());default:try{return!0===Kameleoon.Utils.runProtectedScript(t)}catch(e){return!1}}}obtainIndexes(e){switch(this.obtainType(e)){case 0:case 1:return[0];default:let e=[];let t=Number.NEGATIVE_INFINITY;for(let r in Kameleoon.Internals.runtime.Gatherer.configuration.referrers){let n=Kameleoon.Internals.runtime.Gatherer.configuration.referrers[r];if(this.obtainMatches(n)){let a=n.priority;if(null==a)a=Number.NEGATIVE_INFINITY;if(a>=t){if(a>t){e=[];t=a}e.push(parseInt(r)+1)}}}if(0==e.length)e.push(null);return e}}obtainIsIgnored(e){let t=this.obtain();if(Kameleoon.Internals.runtime.Gatherer.configuration.directNoneReferrerOnlyFirst)if(""==t&&!e)return!0;let r=window.location.pathname;let n=Kameleoon.Internals.runtime.Gatherer.configuration.noReferrerPages.length;for(let e=0;e<n;e++)if(r==Kameleoon.Internals.runtime.Gatherer.configuration.noReferrerPages[e])return!0;return!1}obtainMatches(e){let t=e.detections;for(let e=0;e<t.length;e++)if(this.obtainDetectionMatches(t[e]))return!0;return!1}obtainType(e){if(this.obtainIsIgnored(e))return 0;if(Kameleoon.Internals.runtime.storedData.obtainField("Gatherer","startsOfVisitForCurrentPage")>1)return 1;return 3}}class StoredData{constructor(e){this.Gatherer={};this.Runtime={};this.Vars=Kameleoon.Utils.readLocalData("kameleoonVars","LS")||{};this.Visitor={};this.canSave=!1;if(e){let a="";if(e[Kameleoon.Internals.runtime.dataKeyName]){a=e[Kameleoon.Internals.runtime.dataKeyName];if(e.Kameleoon)Kameleoon.Utils.eraseLocalData("kameleoonData",null,"LS")}else if(e.kameleoonData)a=e.kameleoonData;if(Kameleoon.Internals.runtime.simulationMode)if(e.kameleoonDataSimulation||e.kameleoonSimulationVisitorData)a=e.kameleoonDataSimulation||e.kameleoonSimulationVisitorData;let t=Kameleoon.Utils.unobfuscateString(a);let i=t&&JSON.parse(t)||{};this.Gatherer=i.Gatherer||{};this.Runtime=i.Runtime||{};this.Vars=i.Vars||e.kameleoonVars||{};this.Visitor=i.Visitor||{}}else{let e=Kameleoon.Utils.readLocalData("kameleoonData","LS");if(Kameleoon.Internals.configuration.useMultipleSiteCodes){let a=Kameleoon.Utils.readLocalData(Kameleoon.Internals.runtime.dataKeyName,"LS",!0);if(a)e=a;Kameleoon.Utils.eraseLocalData("kameleoonData",null,"LS")}if(Kameleoon.Internals.runtime.simulationMode){const a=Kameleoon.Utils.readLocalData("kameleoonDataSimulation","LS",!0);const t=Kameleoon.Utils.readLocalData("kameleoonSimulationVisitorData","LS",!0);if(a||t)e=a||t}if(e){this.Gatherer=e.Gatherer;this.Runtime=e.Runtime||{};this.Vars=e.Vars||this.Vars;this.Visitor=e.Visitor}}Kameleoon.Utils.eraseLocalData("kameleoonVars",null,"LS");for(let e in this.Vars)if(Kameleoon.Internals.runtime.pageStartTime>this.Vars[e].date)delete this.Vars[e];Kameleoon.Utils.setInterval((()=>{if(this.canSave){this.save(!0);this.canSave=!1}}),1e3);Kameleoon.Utils.addEventListener(window,Kameleoon.Internals.runtime.beforeUnloadEvent,(()=>{if(window.self!==window.top){let e=Kameleoon.Utils.readLocalData(Kameleoon.Internals.runtime.simulationMode?"kameleoonSimulationVisitorData":Kameleoon.Internals.runtime.dataKeyName,"LS");if(e&&e.Visitor&&this.Visitor&&this.Visitor.totalVisits<e.Visitor.totalVisits)this.update(e)}this.save(!0)}))}obtainField(e,a,t){return this[e][a]||t||null}resetForStartOfVisit(){this.Runtime={}}saveField(e,a,t){this[e][a]=t;this.save(!1)}save(e){if(e)Kameleoon.Utils.createLocalData(Kameleoon.Internals.runtime.simulationMode?"kameleoonSimulationVisitorData":Kameleoon.Internals.runtime.dataKeyName,this,Kameleoon.Internals.runtime.simulationMode?1/24:Utils.MAX_STORAGE_DAYS,null,"LS",!0);else this.canSave=!0}update(e){this.Gatherer=e.Gatherer||this.Gatherer;this.Runtime=e.Runtime||this.Runtime;this.Vars=e.Vars||this.Vars;this.Visitor=e.Visitor||this.Visitor}}class TimeZone{constructor(){}obtainId(){let t;try{t="undefined"!=typeof Intl&&Intl.DateTimeFormat().resolvedOptions?Intl.DateTimeFormat().resolvedOptions().timeZone:null}catch(e){t=null}return t}}class VisitEvent{constructor(e){this.eventType=e.type;this.visitEvent=e}track(e){let t=()=>{let t=new this.visitEvent(e);Kameleoon.Internals.runtime.Visitor.saveToStoredData();if((!e||!e.notTrack&&!t.notTrack)&&Kameleoon.Internals.configuration.track)Kameleoon.Internals.runtime.RequestManager.addRequest(t);Kameleoon.Internals.runtime.storedData.save(this.visitEvent.urgent)};if(!Kameleoon.Internals.runtime.Visitor.currentVisit.isVisitFinished())t();else if(this.eventType==VisitEvent_Activity.type&&Kameleoon.Internals.runtime.Gatherer.active){Kameleoon.Internals.runtime.Visitor=new Visitor;Kameleoon.Gatherer.track(VisitEvent_Page);Kameleoon.Gatherer.track(VisitEvent_StaticData);Kameleoon.Gatherer.CustomData.run();Kameleoon.Internals.runtime.gathererRun=!0;t()}}}class VisitEvent_Main{constructor(t){this.obtainRequestData=()=>{let t="eventType="+this.eventType;for(let e in this){if("function"==typeof this[e]||VisitEvent_Main.NOT_TRACK_FIELD[e])continue;t+=`&${e}=${this.addValueParameter(this[e])}`}return t};this.addValueParameter=t=>{if("object"==typeof t)return encodeURIComponent(JSON.stringify(t));else if("string"==typeof t)return encodeURIComponent(t);return t};this.time=(new Date).getTime();this.nonce=Kameleoon.Utils.obtainRandomString(VisitEvent_Main.NONCE_LENGTH,VisitEvent_Main.HEXADECIMAL_ALPHABET)}}VisitEvent_Main.HEXADECIMAL_ALPHABET="0123456789ABCDEF";VisitEvent_Main.NONCE_LENGTH=16;VisitEvent_Main.NOT_TRACK_FIELD={eventType:1,time:1,notTrack:1,type:1,urgent:1};class VisitEvent_Activity extends VisitEvent_Main{constructor(){super();this.eventType=VisitEvent_Activity.type;this.clicks=Kameleoon.Internals.runtime.Gatherer.clicks;Kameleoon.Internals.runtime.Visitor.currentVisit.addActivity(this.time,Kameleoon.Internals.runtime.Gatherer.active);Kameleoon.Internals.runtime.Visitor.currentVisit.addNumberClicks(this.clicks);Kameleoon.Internals.runtime.Gatherer.active=!1;Kameleoon.Internals.runtime.Gatherer.clicks=0}static initialize(){let e=()=>{Kameleoon.Internals.runtime.Gatherer.active=!0};let t=()=>{e();Kameleoon.Internals.runtime.Gatherer.clicks++};Kameleoon.Utils.addEventListener(document,"mousemove",e,!1);Kameleoon.Utils.addEventListener(document,"scroll",e,!1);Kameleoon.Utils.addEventListener(document,"click",t,!1);Kameleoon.Utils.setInterval((()=>{if(Kameleoon.Internals.runtime.Gatherer.active)Kameleoon.Gatherer.track(this)}),this.ACTIVITY_TRACKING_INTERVAL,!0)}}VisitEvent_Activity.ACTIVITY_TRACKING_INTERVAL=15*1e3;VisitEvent_Activity.type="activity";VisitEvent_Activity.urgent=!1;class VisitEvent_AdBlocker extends VisitEvent_Main{constructor(){super();this.eventType=VisitEvent_AdBlocker.type;Kameleoon.Internals.runtime.Visitor.currentVisit.addAdBlocker()}}VisitEvent_AdBlocker.type="adBlocker";VisitEvent_AdBlocker.urgent=!1;class VisitEvent_Conversions extends VisitEvent_Main{constructor(e){super();this.eventType=VisitEvent_Conversions.type;this.goalId=e.goalId;this.negative=!0===e.negative;let i,t=!1;let n=Kameleoon.Internals.runtime.storedData.obtainField("Gatherer","revenuesByGoalId",{});let s=n[this.goalId];if(this.negative)if(s&&s.length>0){i=s.splice(-1)[0];if(0==s.length)delete n[this.goalId]}else t=!0;else{i=e.revenue;if(isNaN(i))i=0;if(!s)s=[];s.push(i);n[this.goalId]=s.splice(-10)}this.revenue=i;if(!t){Kameleoon.Internals.runtime.storedData.saveField("Gatherer","revenuesByGoalId",n);Kameleoon.Internals.runtime.Visitor.currentVisit.addConversions(this.goalId,1,this.revenue,this.negative);}}}VisitEvent_Conversions.type="conversion";VisitEvent_Conversions.urgent=!0;class VisitEvent_CustomData extends VisitEvent_Main{constructor(t){super();this.eventType=VisitEvent_CustomData.type;this.index=t.index;this.overwrite=t.overwrite||!1;this.notTrack=t.value.length>VisitEvent_CustomData.MAX_SUM_CUSTOM_DATA_VALUES_LENGTHES_IN_A_REQUEST||t.customData.localOnly;this.valuesCountMap=t.valueToAdd;this.mappingIdentifier=1==t.customData.mappingIdentifier?"true":"false";Kameleoon.Internals.runtime.Visitor.currentVisit.addCustomData(this.index,this.valuesCountMap,this.overwrite);if("PAGE"===t.customData.scope)this.overwrite=t.overwriteDefault||!1}}VisitEvent_CustomData.MAX_SUM_CUSTOM_DATA_VALUES_LENGTHES_IN_A_REQUEST=1e3;VisitEvent_CustomData.type="customData";VisitEvent_CustomData.urgent=!0;class VisitEvent_Page extends VisitEvent_Main{constructor(){super();this.eventType=VisitEvent_Page.type;const e=Kameleoon.Utils.computeCurrentPageCleanAbsoluteURL();const t=document.title;const r=Kameleoon.Utils.computeCurrentPageCanonicalURL();const i=Kameleoon.Gatherer.Referrer.obtainCorrected(Kameleoon.Internals.runtime.Gatherer.startOfVisit);this.href=e&&e.slice(0,Kameleoon.Gatherer.MAX_HREF_LENGTH_IN_A_REQUEST);this.title=t.slice(0,Kameleoon.Gatherer.MAX_PAGE_TITLE_LENGTH_IN_A_REQUEST);this.keyPagesIndices=Kameleoon.Gatherer.KeyPage.obtainIndexes();this.referrersIndices=Kameleoon.Gatherer.Referrer.obtainIndexes(Kameleoon.Internals.runtime.Gatherer.startOfVisit);if(r)this.canonicalHref=r;if(null!=i)this.referrerHref=i;if(Kameleoon.Internals.configuration.cleanHrefTracking){if(this.href)this.href=this.href.replace(/(\?|\#)(.*)/gi,"");if(this.referrerHref)this.referrerHref=this.referrerHref.replace(/(\?|\#)(.*)/gi,"")}Kameleoon.Internals.runtime.Visitor.currentVisit.addPage(this.time,e,this.keyPagesIndices,this.referrersIndices);Kameleoon.Internals.runtime.Visitor.currentVisit.addActivity(this.time,!0)}}VisitEvent_Page.type="page";VisitEvent_Page.urgent=!0;class VisitEvent_StaticData extends VisitEvent_Main{constructor(){super();this.eventType=VisitEvent_StaticData.type;this.obtainInfluences=()=>{let e=Kameleoon.Internals.runtime.Visitor.visits;let t=Kameleoon.Internals.runtime.Visitor.currentVisit.startDate;let i={experiments:{},personalizations:{}};let n=e=>{for(let t in e)if(e[t][1]<0||"-1"==t||null==e[t][0]||"null"==e[t][0])delete e[t];return e};e.forEach((e=>{for(let n in e.ExperimentActivations){let s=e.ExperimentActivations[n];if(s.influence){let e=s.influence-(t-s.times.slice(-1)[0]);i.experiments[n]=[parseInt(s.associatedVariationID),e]}}for(let n in e.PersonalizationActivations){let s=e.PersonalizationActivations[n];if(s.influence){let e=s.influence-(t-s.times.slice(-1)[0]);i.personalizations[n]=[1,e]}}}));this.experimentInfluences=n(i.experiments);this.personalizationInfluences=n(i.personalizations)};this.timeSincePreviousVisit=Kameleoon.Internals.runtime.Visitor.obtainTimeSincePreviousVisit();this.browser=Kameleoon.Gatherer.Browser.obtain();this.browserIndex=Kameleoon.Gatherer.Browser.obtainIndex();this.browserVersion=Kameleoon.Internals.runtime.Device.browserVersion;this.os=Kameleoon.Gatherer.OperatingSystem.obtain();this.osIndex=Kameleoon.Gatherer.OperatingSystem.obtainIndex();this.windowWidth=Kameleoon.Internals.runtime.Device.windowWidth;this.windowHeight=Kameleoon.Internals.runtime.Device.windowHeight;this.screenWidth=Kameleoon.Internals.runtime.Device.screenWidth;this.screenHeight=Kameleoon.Internals.runtime.Device.screenHeight;this.timeZoneId=Kameleoon.Gatherer.TimeZone.obtainId();this.localeLanguageTag=Kameleoon.Gatherer.Language.obtainLocaleTag();this.deviceType=Kameleoon.Internals.runtime.Device.type.toLocaleUpperCase();this.visitNumber=Kameleoon.Internals.runtime.Visitor.currentVisit.visitNumber;this.obtainInfluences()}}VisitEvent_StaticData.type="staticData";VisitEvent_StaticData.urgent=!0;class VisitEvent_TargetingSegments extends VisitEvent_Main{constructor(t){super();this.eventType=VisitEvent_TargetingSegments.type;this.id=t.id;Kameleoon.Internals.runtime.Visitor.currentVisit.addTargetingSegment(this.time,this.id)}}VisitEvent_TargetingSegments.type="targetingSegment";VisitEvent_TargetingSegments.urgent=!1;class CommandQueue{constructor(e,o){this.executeCommand=e=>{try{if(e.command)e=e.command;if("function"===typeof e)e();else{let o=e[0];let s=o.split(".");let m;let t;if("Kameleoon"!=s[0]){m=Kameleoon.API;t=Kameleoon.API[s[0]]}else t=Kameleoon.API[s[2]];s.forEach((e=>{if(null==m)m=window[e];else m=m[e]}));m.apply(t,Array.prototype.slice.call(e,1))}}catch(e){console.log(e)}};this.commands=e&&e.forEach?e:[];this.commands.push=e=>{if("IMMEDIATE"==o)e.level==o?this.executeCommand(e):this.commands.unshift(e);else this.executeCommand(e)};let s=[];if("IMMEDIATE"==o)this.commands.forEach(((e,o)=>{if("IMMEDIATE"==e.level){s.push(e);this.commands.splice(o,1)}}));else{this.commands.forEach((e=>{s.push(e)}));this.commands.splice(0,this.commands.length)}s.forEach(this.executeCommand);return this.commands}}class Campaigns{constructor(){this.experiments={};this.personalizations={}}addCampaign(i){if(i.experimentAction)this.experiments[i.id.toString()]=i;else this.personalizations[i.id.toString()]=i}obtainCampaign(i,t){if(null!=i){if(t)return this[t+"s"][i.toString()];return this.experiments[i.toString()]||this.personalizations[i.toString()]}}obtainCampaignsList(i){return Object.values(this[i])}}class Consent{constructor(){this.disable=(e,n)=>{Kameleoon.Utils.sendKameleoonCustomEvent("Internals",{type:"consent/disable",consentType:e});if(e&&"BOTH"!=e)this[e]=!1;else{this.AB_TESTING=!1;this.PERSONALIZATION=!1}if(1!=n)this.write();Kameleoon.Utils.sendKameleoonCustomEvent.call(window,"LegalConsentUpdated",{legalConsentUpdate:this.getConsent()})};this.enable=(e,n)=>{Kameleoon.Utils.sendKameleoonCustomEvent("Internals",{type:"consent/enable",consentType:e});if(e&&"BOTH"!=e)this[e]=!0;else{this.AB_TESTING=!0;this.PERSONALIZATION=!0}if(Kameleoon.Internals.runtime&&Kameleoon.Internals.runtime.RequestManager){if(Kameleoon.Internals.configuration.requestsAfterConsent)Kameleoon.Internals.runtime.loadExternalRequests();this.purge()}if(1!=n)this.write();Kameleoon.Utils.sendKameleoonCustomEvent.call(window,"LegalConsentUpdated",{legalConsentUpdate:this.getConsent()})};this.getConfiguredConsent=()=>({AB_TESTING:Kameleoon.Internals.configuration.abtestConsent,PERSONALIZATION:Kameleoon.Internals.configuration.personalizationConsent});this.getConsent=()=>({AB_TESTING:this.AB_TESTING,PERSONALIZATION:this.PERSONALIZATION});this.hasGlobalConsent=()=>this.AB_TESTING||this.PERSONALIZATION||Kameleoon.Internals.runtime&&Kameleoon.Internals.runtime.kameleoonFull;this.initialize=e=>{Kameleoon.Utils.sendKameleoonCustomEvent("Internals",{type:"consent/initialize",consent:e});this.AB_TESTING=e.AB_TESTING;this.PERSONALIZATION=e.PERSONALIZATION;this.initializeIAB()};this.initializeIAB=()=>{};this.purge=()=>{if(Kameleoon.Internals.runtime){let e=e=>{if(null!=e)for(let n in e)Kameleoon.Utils.createLocalData(e[n].name,e[n].value,e[n].days,e[n].domain,e[n].forceLocalAccess,e[n].jsonFormat,null,!0)};e(Kameleoon.Internals.runtime.localDataMap&&Kameleoon.Internals.runtime.localDataMap["LS"]);e(Kameleoon.Internals.runtime.localDataMap&&Kameleoon.Internals.runtime.localDataMap["COOKIE"]);Kameleoon.Internals.runtime.localDataMap=null;}};this.setup=()=>{let e={AB_TESTING:!1,PERSONALIZATION:!1};let n=Kameleoon.Internals.runtime.readFromStorageOrExternal("kameleoonLegalConsent","LS");if(null==n)n=Kameleoon.Internals.runtime.readFromStorageOrExternal("kameleoonLocalDataConsent","LS");if(null!=n)if(1==n)e={AB_TESTING:!0,PERSONALIZATION:!0};else e=n;else{e={AB_TESTING:"OFF"==Kameleoon.Internals.configuration.abtestConsent?!0:null,PERSONALIZATION:"OFF"==Kameleoon.Internals.configuration.personalizationConsent?!0:null};if(!Kameleoon.Internals.configuration.abtestingSetup)e.AB_TESTING=null;if(!Kameleoon.Internals.configuration.personalizationSetup)e.PERSONALIZATION=null;}this.initialize(e)};this.write=()=>{Kameleoon.Utils.createLocalData("kameleoonLegalConsent",this.getConsent(),Utils.MAX_STORAGE_DAYS,null,"LS",!0,null,!0)};this.AB_TESTING=!1;this.PERSONALIZATION=!1}}class Device{constructor(){let e=Kameleoon.Utils.bowser.parse(navigator.userAgent);let t=e.browser.version;try{if(t.split(".").length>1)t=t.split(".")[0]+"."+t.split(".")[1]}catch(e){console.log(e)}this.browser=e.browser.name||"Other";this.browserVersion=t?parseFloat(t):null;this.type="tablet"==e.platform.type?"Tablet":"mobile"==e.platform.type?"Phone":"Desktop";if("Safari"==this.browser&&"Desktop"==this.type&&"ontouchend"in document.documentElement)this.type="Tablet"}get adBlocker(){return Kameleoon.Internals.runtime.adBlocker}get os(){return Kameleoon.Gatherer.OperatingSystem.obtain()}get screenHeight(){return window.screen.height}get screenWidth(){return window.screen.width}get timeZone(){return Kameleoon.Gatherer.TimeZone.obtainId()}get windowHeight(){return window.innerHeight}get windowWidth(){return window.innerWidth}}Device.OSS={CHROME:"Chrome OS",MAC:"Mac",IOS:"iOS",LINUX:"Linux",ANDROID:"Android","WINDOWS PHONE":"Windows Phone"};class Goals{constructor(){this.checkKameleoonGoals=()=>{let e=[];let n=[];let o=[];let t=[];Kameleoon.Internals.runtime.goals.forEach((l=>{switch(l.type){case"URL":{let n=new RegExp(l.url);if(n.test(Kameleoon.Utils.computeCurrentPageCleanAbsoluteURL()))e.push({goal:l});break}case"PAGE_VIEWS":if(Kameleoon.Internals.runtime.gathererRun){let n=Kameleoon.Internals.runtime.Visitor.currentVisit.obtainPageNumberViews();if((null==l.minPageViews||n>=l.minPageViews)&&(null==l.maxPageViews||n<=l.maxPageViews))e.push({goal:l})}break;case"ENGAGEMENT":n.push({goal:l});break;case"TIME_SPENT":o.push(l);break;case"SCROLL":t.push(l);break}}));if(e.length>0)this.processConversions(e);Kameleoon.Utils.addEventListener(document,Kameleoon.Internals.runtime.mouseDownEvent,(e=>{this.processConversions(n)}),!0);if(o.length>0)Kameleoon.Utils.setInterval((()=>{let e=[];o.forEach((n=>{let o=Kameleoon.Internals.runtime.Visitor.currentVisit.lastActivityDate-Kameleoon.Internals.runtime.Visitor.currentVisit.startDate;if((null==n.minTimeSpent||o>=n.minTimeSpent)&&(null==n.maxTimeSpent||o<=n.maxTimeSpent))e.push({goal:n})}));if(e.length>0)this.processConversions(e)}),1e3);Kameleoon.Utils.addEventListener(document,"scroll",(e=>{if(document.body){let e=[];t.forEach((n=>{if(!n.sent){let o=null,t=null;switch(n.scrollTrackingType){case"PIXELS_HEIGHT":o=Math.ceil(document.documentElement.scrollTop||document.body.scrollTop)+window.innerHeight;t=n.scrollTrackingValue;break;case"PERCENTAGE":o=(Math.ceil(document.documentElement.scrollTop||document.body.scrollTop)+window.innerHeight)/document.body.scrollHeight*100;t=n.scrollTrackingValue;break;case"ELEMENT":o=window.innerHeight;let e=Kameleoon.Utils.querySelectorAll(n.selector);if(e.length>0)t=e[0].getBoundingClientRect().top+e[0].offsetHeight;break}if(null!==o&&null!==t&&t<=o){e.push({goal:n});n.sent=!0}}}));if(e.length>0)this.processConversions(e)}}),!0);};this.processConversions=e=>{if(Kameleoon.Internals.runtime.gathererRun)for(let n=0,o=e.length;n<o;++n){let o=e[n];let t=o.goal;let l=!0===o.negative;if(l||"PAGE_VIEWS"!=t.type&&"TIME_SPENT"!=t.type&&"ENGAGEMENT"!=t.type||0==Kameleoon.Internals.runtime.Visitor.currentVisit.obtainNumberConversions(t.id)){Kameleoon.Utils.sendKameleoonCustomEvent.call(window,"ConversionTriggered",new APIGoal(t),"goal/process");Kameleoon.Gatherer.track(VisitEvent_Conversions,{goalId:t.id,revenue:o.revenue?o.revenue:0,negative:l});}}}}}class KMutationObserver{static addMutationElementsToInternalObjects(e){for(let t=0;t<e.length;++t){const n=e[t];if(n&&n.id)Kameleoon.Internals.runtime.addedIDs["#"+n.id]=!0;if(n&&n.className&&"string"===typeof n.className){const e=n.className.split(" ");for(let t=0;t<e.length;++t)Kameleoon.Internals.runtime.addedClasses["."+e[t]]=!0}}}static checkSelectorInDomTree(e){if(!e.selectors)KMutationObserver.fillClassesAndIdsForSelector(e);if(0===e.selectorClasses.length&&0===e.selectorIDs.length)return!0;let t=!1;for(let n=0;n<e.selectors.length;++n){if(t)break;if(KMutationObserver.checkIDsForSelector(e.selectorIDs[n],e)&&KMutationObserver.checkClassesForSelector(e.selectorClasses[n],e))t=!0}return t}static fillClassesAndIdsForSelector(e){const t=[];const n=[];const o=e.selector&&e.selector.split(",")||[];if(e.currentQuery&&e.selector!=e.currentQuery)o.push(e.currentQuery);o.forEach((e=>{if(-1!==e.indexOf(".")||-1!==e.indexOf("#")){let o;let r;if(-1!==e.indexOf("\\")||-1!==e.indexOf("contains")||-1!==e.indexOf(":not")){const t=e.replace(/(:[^:]+\(.+?\)|\\)/g,"").replace(/(\-)?(\[.*?\])/g,((e,t)=>t?e:""));o=t.match(/\.([^\s.]+)/g);r=t.match(/#([^\s:\[]+)/g)}else{o=e.match(/\.([^\s.:\[]+)/g);r=e.match(/#([^\s:\[>]+)/g)}n.push(o||[]);t.push(r||[])}}));e.selectors=o;e.selectorClasses=n;e.selectorIDs=t;return e}static checkClassesForSelector(e,t){if(null==e)return!0;for(let t=0,n=e.length;t<n;++t){const n=e[t];if(-1===n.indexOf("kameleoon")&&null==Kameleoon.Internals.runtime.addedClasses[n])return!1}return!0}static checkIDsForSelector(e,t){if(null==e)return!0;let n;if(t.options)n=t.options.domReference;for(let o=0,r=e.length;o<r;++o){const r=e[o];if(-1!==r.indexOf("kameleoonElement")){if(n){const e=KMutationObserver.fillClassesAndIdsForSelector({selector:n,checkDomReference:!0});if(!KMutationObserver.checkIDsForSelector(e.selectorIDs[0],e))return!1}if(t.checkDomReference)if(null==Kameleoon.Internals.runtime.addedIDs[r])return!1}else if(null==Kameleoon.Internals.runtime.addedIDs[r])return!1}return!0}static fillInternalObjectsForMutationObserver(e){if(!e)e=document;const t=e.getElementsByTagName("*");for(let e=0,n=t.length;e<n;++e){const n=t[e];if(n.id)Kameleoon.Internals.runtime.addedIDs["#"+n.id]=!0;if(n.className&&"string"===typeof n.className){const e=n.className.split(" ");for(let t=0;t<e.length;++t)Kameleoon.Internals.runtime.addedClasses["."+e[t]]=!0}}}static removeMutationElementsFromInternalObjects(e){for(let t=0;t<e.length;++t){const n=e[t];if(n&&n.id)if(1==Kameleoon.Internals.runtime.addedIDs["#"+n.id])delete Kameleoon.Internals.runtime.addedIDs["#"+n.id]}}static performWaitingElementPresentObject(){for(let e=Kameleoon.Internals.runtime.waitingElementPresentObjects.length-1;e>=0;e-=1){const t=Kameleoon.Internals.runtime.waitingElementPresentObjects[e];if(t&&t.useAntiFlicker)if(KMutationObserver.checkSelectorInDomTree(t)){const n=Kameleoon.Utils.querySelectorAll(t.selector);if(0<n.length){Kameleoon.Utils.runProtectedFunction((function(){t.callback(n)}),!0);Kameleoon.Internals.runtime.waitingElementPresentObjects.splice(e,1)}}}}static performVariationsElementSet(e){}static performAsyncMutations(){Kameleoon.Internals.runtime.domMutationThrottling=!0;if(!KMutationObserver.asyncMutationsTimeoutId)KMutationObserver.asyncMutationsTimeoutId=Kameleoon.Utils.setTimeout((()=>{if(KMutationObserver.mutationList.length>=KMutationObserver.MAX_MUTATIONS_LENGTH_FOR_ITERATION)KMutationObserver.fillInternalObjectsForMutationObserver();else KMutationObserver.mutationList.forEach((e=>{const t=e.addedNodes,n=e.removedNodes;const o=Array.prototype.slice.call(t);const r=Array.prototype.slice.call(n);const s=o.concat(r);KMutationObserver.removeMutationElementsFromInternalObjects(n);KMutationObserver.addMutationElementsToInternalObjects(t);for(let t=0;t<s.length;++t){const n=s[t];if(n&&n.innerHTML&&"childList"===e.type)KMutationObserver.fillInternalObjectsForMutationObserver(n)}}));KMutationObserver.mutationList=[];KMutationObserver.performWaitingElementPresentObject();KMutationObserver.performVariationsElementSet(!0);Kameleoon.Utils.clearTimeout(KMutationObserver.asyncMutationsTimeoutId);KMutationObserver.asyncMutationsTimeoutId=null}),250)}static setMutationObserver(){if(Kameleoon.Internals.runtime.cantUseMutationObserver)return;KMutationObserver.fillInternalObjectsForMutationObserver();const e=document.documentElement;const t={attributes:!0,childList:!0,characterData:!0,subtree:!0};if(!Kameleoon.Internals.runtime.mutationObserver)Kameleoon.Internals.runtime.mutationObserver=new MutationObserver((function(e){let t=!0;if(!Kameleoon.Internals.runtime.domReady&&e.length>=KMutationObserver.MAX_MUTATIONS_LENGTH){KMutationObserver.mutationList=KMutationObserver.mutationList.concat(e);KMutationObserver.performAsyncMutations();return}e.forEach((e=>{const n=e.addedNodes,o=e.removedNodes;const r=Array.prototype.slice.call(n);const s=Array.prototype.slice.call(o);const a=r.concat(s);KMutationObserver.removeMutationElementsFromInternalObjects(o);KMutationObserver.addMutationElementsToInternalObjects(n);for(let n=0;n<a.length;++n){const o=a[n];if((Kameleoon.Internals.runtime.editorMode||Kameleoon.Internals.runtime.kameleoonSelectionIframeMode)&&o&&o.id&&"string"==typeof o.id&&null!==o.id.match("kameleoon"))if(o.closest&&null!==o.closest(".KameleoonProtected"))t=!1;if(t&&o&&o.innerHTML&&"childList"===e.type)KMutationObserver.fillInternalObjectsForMutationObserver(o)}}));KMutationObserver.performWaitingElementPresentObject();KMutationObserver.performVariationsElementSet(t)}));if("function"===typeof Kameleoon.Internals.runtime.mutationObserver.observe)Kameleoon.Internals.runtime.mutationObserver.observe(e,t);if(Kameleoon.Internals.runtime.singlePageSupport)KMutationObserver.setMutationObserverSPA()}static setMutationObserverSPA(){if(Kameleoon.Internals.runtime.mutationObserverSpa)return;Kameleoon.API.Core.runWhenElementPresent("body",(e=>{Kameleoon.Internals.runtime.mutationObserverSpa=new MutationObserver((function(){Kameleoon.Internals.runtime.listenVariations=[];Kameleoon.Internals.runtime.mutationObserverSpa.disconnect();if(Kameleoon.ElementSet)KMutationObserver.checkElementSetIntegrity();KMutationObserver.checkDynamicElements();t()}));const t=()=>{Kameleoon.Internals.runtime.mutationObserverSpa.observe(e[0],{childList:!0,characterData:Kameleoon.ElementSet&&Kameleoon.ElementSet.pageElementSetsSpa.length>0,subtree:!0})};t()}))}}KMutationObserver.MAX_MUTATIONS_LENGTH=3e3;KMutationObserver.MAX_MUTATIONS_LENGTH_FOR_ITERATION=5e3;KMutationObserver.asyncMutationsTimeoutId=null;KMutationObserver.mutationList=[];KMutationObserver.checkDynamicElements=()=>{Kameleoon.Internals.runtime.waitingDynamicElements.forEach((e=>{const t=Kameleoon.Utils.querySelectorAll(e.selector).filter((t=>null==t.getAttribute(e.attribute)));t.length>0&&e.callback(t)}))};KMutationObserver.checkElementSetIntegrity=()=>{};KMutationObserver.resetElementSet=(e,t,n)=>{};KMutationObserver.containsDomOperationElements=e=>{};class Logger{constructor(){this.MAX_REQUESTS_PER_VISIT=3;this.baseUrl="https://logger.kameleoon.com/api/2/store/?sentry_key=d8dc96c209184885ab9643cbaf1eb86f&sentry_version=7";this.canSend=()=>{if(Kameleoon.Internals.runtime&&Kameleoon.Internals.runtime.Consent.hasGlobalConsent())if(this.errorLoggerIds.length<this.MAX_REQUESTS_PER_VISIT){let e=Kameleoon.Internals.runtime.storedData.obtainField("Runtime","loggerPopulation");if(null==e){this.population=e=Math.random();Kameleoon.Internals.runtime.storedData.saveField("Runtime","loggerPopulation",e)}if(e<.01)return!0}return!1};this.generateRandomIdAsString=(e,t,n)=>Kameleoon.Utils.computeStringSha256(e+t+n).substr(0,32);this.generateRequestDataAsString=(e,t,n,r)=>{let o={tags:{siteCode:Kameleoon.Internals.configuration.siteCode},user:{},environment:Kameleoon.Internals.configuration.environment,platform:"javascript",event_id:t,request:{url:location.href,headers:{"User-Agent":navigator.userAgent}},exception:{values:[{type:e.name,value:e.stack?e.stack:e.message,stacktrace:{frames:[{filename:n}]},mechanism:{data:{mode:"stack",message:e.stack?e.stack:e.message,name:e.name},handled:!1,type:"onerror"}}]}};if(r){o.tags["action-id"]=r.id;o.tags["action-name"]=r.name;o.tags["action-type"]=r.experimentAction?"experiment":"personalization"}try{o.user={id:Kameleoon.Internals.runtime&&Kameleoon.Internals.runtime.Visitor&&Kameleoon.Internals.runtime.Visitor.currentVisit.visitorCode}}catch(e){o.user={id:"no_visitor_code"}}return JSON.stringify(o)};this.send=(e,t,n)=>{if("DEVELOPMENT"==Kameleoon.Internals.configuration.environment)console.error(e);try{this.errorLoggerIds=Kameleoon.Internals.runtime&&Kameleoon.Internals.runtime.storedData.obtainField("Runtime","loggerRequestsSend")||this.errorLoggerIds;let r=this.generateRandomIdAsString(e.message,Kameleoon.Internals.configuration.siteCode,Kameleoon.Internals.configuration.environment);if(-1==this.errorLoggerIds.indexOf(r)){this.errors.push(e);let o=e.stack?e.stack:e.message;if(this.canSend()&&o&&o.trim().length>0){let o=new XMLHttpRequest;o.open("POST",this.baseUrl,!0);o.timeout=2e3;o.send(this.generateRequestDataAsString(e,r,t,n));Kameleoon.Internals.runtime&&Kameleoon.Internals.runtime.storedData.saveField("Runtime","loggerRequestsSend",this.errorLoggerIds)}this.errorLoggerIds.push(r);if(Kameleoon.Internals.runtime.parameters.kameleoonDebug||localStorage.kameleoonExtensionIsAdmin)console.log(e)}}catch(t){this.errors.push(e)}};this.errorLoggerIds=[];this.errors=[]}}class OnlineMeanAndDeviation{constructor(e){this.dimension=e;this.mean=[];this.nbUpdates=[];this.m2=[];this.deviation=[];for(let t=0;t<e;++t){this.mean[t]=0;this.nbUpdates[t]=0;this.m2[t]=0;this.deviation[t]=0}this.update=(e,t=1)=>{if(t>0)for(let n=0;n<this.dimension;++n)if(!isNaN(e[n])&&isFinite(e[n])){let i=this.mean[n]-e[n];let a=this.nbUpdates[n]+t;this.m2[n]=this.m2[n]+i/a*i*this.nbUpdates[n]*t;this.deviation[n]=Math.sqrt(this.m2[n]/a);this.mean[n]=this.mean[n]/a*this.nbUpdates[n]+e[n]/a*t;this.nbUpdates[n]=a}}}}OnlineMeanAndDeviation.createFromDifferences=(e,t,n,i)=>{let a=new OnlineMeanAndDeviation(1);let s=e.length;let l=0;if(l<s){let h=e[l];l++;while(l<s){let s=e[l];l++;let o=s-h;if(o<0&&t||0==o&&n||o>0&&i)a.update([o]);h=s}}return a};OnlineMeanAndDeviation.createFromValues=e=>{let t=new OnlineMeanAndDeviation(1);for(let n=0,i=e.length;n<i;n++)t.update([e[n]]);return t};OnlineMeanAndDeviation.createFromBooleanValues=e=>{let t=new OnlineMeanAndDeviation(1);for(let n=0,i=e.length;n<i;n++)t.update([e[n]?1:0]);return t};class RequestManager{constructor(){this.processRequests=()=>{if(this.eventsToSend.length>0)if(this.validateTrackingRequest())if((!Kameleoon.Internals.runtime.simulationMode||Kameleoon.Internals.runtime.enableRemoteVisitorSynchronization)&&!Kameleoon.Internals.runtime.proxyMode&&!Kameleoon.Internals.runtime.kameleoonSelectionIframeMode){let e=this.eventsToSend.splice(0,1e3);let t=this.obtainRequestBody(e);this.send(this.obtainVisitUrl(),"POST",t,(()=>{}),(()=>{this.createErrorEventsQueue(t)}));if(this.eventsToSend.length>0)this.processRequests()}};this.obtainRequestBody=e=>{let t="";t+=e.reduce(((e,t)=>{if(!t.notTrack)e+=t.obtainRequestData()+"\n";return e}),"");if(sessionStorage.getItem("kameleoonRequestEvents")){t+=sessionStorage.getItem("kameleoonRequestEvents");sessionStorage.removeItem("kameleoonRequestEvents")}return t};this.obtainVisitUrl=()=>{const e=Kameleoon.Internals.runtime.Visitor.currentVisit.visitorCode;return`${this.url}/visit/events?siteCode=${this.siteCode}&visitorCode=${e}&itp=${"Safari"===Kameleoon.Internals.runtime.Device.browser}`};this.obtainIpUrl=()=>this.url+"/ip";this.obtainGeolocationUrl=()=>this.url+"/geolocation";this.send=(e,t,n,s,i,o)=>{let r=new XMLHttpRequest;r.open(t,e,!0);if(s)r.onreadystatechange=function(e){s.bind(r)(e.target)};if(i){r.onabort=function(e){i.bind(r)(e.target)};r.onerror=function(e){i.bind(r)(e.target)};r.ontimeout=function(e){i.bind(r)(e.target)}}r.timeout=o||15*60*1e3;r.send("POST"==t&&n?n:null);};this.sendActiveScript=()=>{this.send(`${this.url}/active-script/event?siteCode=${this.siteCode}`,"POST")};this.sendProduct=(e,t)=>{this.send(`${this.url}/product/events?siteCode=${this.siteCode}&ean=${encodeURIComponent(e.toString())}`,"POST",t)};this.eventsToSend=[];this.url=Kameleoon.Internals.runtime.DATA_URL;this.siteCode=Kameleoon.Internals.configuration.siteCode;Kameleoon.Utils.setInterval(this.processRequests.bind(this),500);Kameleoon.Utils.addEventListener(window,Kameleoon.Internals.runtime.beforeUnloadEvent,"Safari"===Kameleoon.Internals.runtime.Device.browser?()=>this.eventsToSend.length&&this.createErrorEventsQueue(this.obtainRequestBody(this.eventsToSend)):this.processRequests.bind(this))}addRequest(e){this.eventsToSend.push(e);if("page"===e.eventType)this.processRequests()}createErrorEventsQueue(e){if(e)sessionStorage.setItem("kameleoonRequestEvents",(sessionStorage.getItem("kameleoonRequestEvents")||"")+e)}validateTrackingRequest(){let e=Kameleoon.Internals.runtime.ipIsTrackerAccepted;let t=Kameleoon.Internals.configuration.trackerExcludedIPRanges.length>0;if(t&&!e||!Kameleoon.Internals.runtime.Consent.hasGlobalConsent())return!1;else return!0}}class Segment{}class Targeting{constructor(){this.segments={};this.obtainSegment=e=>e&&this.segments[e];this.checkTargetingCondition=(e,t,i)=>{let n;if(null==t.numberTargetingCheckings)t.numberTargetingCheckings=0;if(!this.checkIfTargetingMustBeComputed(t.targeting,t.rescheduleTargeting||0==t.numberTargetingCheckings,void 0))n={targeting:t.targeting,rescheduleTargeting:!1};else{let r=Kameleoon.Targeting["evaluate_"+t.type];let a;if(null!=r)a=r.bind(this)(t,e,i);else a=null;if(null==a)a={targeting:void 0,rescheduleTargeting:!1};let g=a.targeting;if(!0!==t.include)if(void 0===g){if(!0===a.excludedUndefinedIsTargeted)g=!0}else g=!g;n={targeting:g,rescheduleTargeting:this.checkIfTargetingMustBeComputed(g,a.rescheduleTargeting,void 0)};t.targeting=n.targeting;t.rescheduleTargeting=n.rescheduleTargeting;t.numberTargetingCheckings++}if(!0===n.targeting)n.weight=t.weight;else n.weight=0;return n};this.checkTargetingSegmentsTargeting=e=>{let t=[];for(let i=0,n=e.length;i<n;++i){let n=e[i];if(null==n.numberTargetingCheckings)n.numberTargetingCheckings=0;if(this.checkIfTargetingMustBeComputed(n.targeting,n.rescheduleTargeting||0==n.numberTargetingCheckings,!1))t.push(n)}e=t;for(let t=0,i=e.length;t<i;++t){let i=e[t];let n=this.checkTree(null,i?i.tree:null,!1,i);i.targeting=n.targeting;i.rescheduleTargeting=n.rescheduleTargeting;i.numberTargetingCheckings++}let i=[];for(let t=0,n=e.length;t<n;++t){let n=e[t];if(this.checkIfTargetingMustBeComputed(n.targeting,n.rescheduleTargeting,!1))i.push(n)}if(i.length>0){let e=Kameleoon.Utils.setTimeout((()=>{Kameleoon.Utils.clearTimeout(e);this.processTargetingSegments(i)}),Kameleoon.Internals.runtime.domReady?Kameleoon.Internals.runtime.PAGE_LOADED_POLL_DELAY:Kameleoon.Internals.runtime.PAGE_LOADING_POLL_DELAY)}};this.checkTree=(e,t,i,n)=>{let r;if(null==t){r={targeting:!0,rescheduleTargeting:!1};if(i)r.weight=0}else{if(null==t.numberTargetingCheckings)t.numberTargetingCheckings=0;if(!this.checkIfTargetingMustBeComputed(t.targeting,t.rescheduleTargeting||0==t.numberTargetingCheckings,i)){r={targeting:t.targeting,rescheduleTargeting:!1};if(i)r.weight=t.weight}else{if(null!=t.targetingCondition)r=this.checkTargetingCondition(e,t.targetingCondition,n);else{let a=this.checkTree(e,t.leftChild,i,n);let g=Kameleoon.Internals.runtime.simulationMode||i;if(!g)switch(a.targeting){case!0:if(!t.orOperator)g=!0;break;case!1:if(t.orOperator)g=!0;break;case void 0:default:g=!0;break}let l=null;if(g)l=this.checkTree(e,t.rightChild,i,n);let s;switch(a.targeting){case!0:if(t.orOperator)s=!0;else switch(l.targeting){case!0:s=!0;break;case!1:s=!1;break;case void 0:default:s=void 0;break}break;case!1:if(t.orOperator)switch(l.targeting){case!0:s=!0;break;case!1:s=!1;break;case void 0:default:s=void 0;break}else s=!1;break;case void 0:default:if(t.orOperator)switch(l.targeting){case!0:s=!0;break;case!1:s=void 0;break;case void 0:default:s=void 0;break}else switch(l.targeting){case!0:s=void 0;break;case!1:s=!1;break;case void 0:default:s=void 0;break}break}r={targeting:s,rescheduleTargeting:this.checkIfTargetingMustBeComputed(s,a.rescheduleTargeting||g&&l.rescheduleTargeting,i)};if(i){let e;if(t.orOperator)e=Math.max(a.weight,l.weight);else e=a.weight+l.weight;r.weight=e}}t.targeting=r.targeting;t.rescheduleTargeting=r.rescheduleTargeting;if(i)t.weight=r.weight}t.numberTargetingCheckings++}return r};this.computeDisplayableTree=e=>{let t=new Array;let i=new Array;this.computeDisplayableTreeFirstLevelAddIn(e,t,i);if(i.length>0){let e=new Array;let n=new Array;let r=this.createIterator(t);let a=this.createIterator(i);while(a.hasNext()){let t=a.next();if(Kameleoon.Utils.testEmptyMap(t.conditions)){if(a.hasNext())r.next()}else{n.push(t);if(a.hasNext())e.push(r.next())}}t=n.length>0?e.slice(0,n.length-1):e;i=n}return{firstLevelOrOperators:t,secondLevel:i}};this.computeDisplayableTreeFirstLevelAddIn=(e,t,i)=>{if(null!=e)if(null==e.targetingCondition)if(0==e.orGuiLevel){this.computeDisplayableTreeFirstLevelAddIn(e.leftChild,t,i);t.push(e.orOperator);this.computeDisplayableTreeFirstLevelAddIn(e.rightChild,t,i)}else i.push(this.computeDisplayableTreeSecondLevel(e));else i.push(this.computeDisplayableTreeSecondLevel(e))};this.computeDisplayableTreeSecondLevel=e=>{let t=new Array;let i=new Array;this.computeDisplayableTreeSecondLevelAddIn(e,t,i);if(i.length>0){let e=new Array;let n=new Array;let r=this.createIterator(t);let a=this.createIterator(i);while(a.hasNext()){let t=a.next();if(t.disabled){if(a.hasNext())r.next()}else{n.push(t);if(a.hasNext())e.push(r.next())}}t=n.length>0?e.slice(0,n.length-1):e;i=n}return{orOperators:t,conditions:i}};this.computeDisplayableTreeSecondLevelAddIn=(e,t,i)=>{if(null!=e)if(null==e.targetingCondition){this.computeDisplayableTreeSecondLevelAddIn(e.leftChild,t,i);t.push(e.orOperator);this.computeDisplayableTreeSecondLevelAddIn(e.rightChild,t,i)}else i.push(e.targetingCondition)};this.flattenTree=e=>{let t=(e,i)=>{if(null!=e)if(null!=e.targetingCondition)return!1===e.targetingCondition.targeting?["!",e.targetingCondition]:e.targetingCondition;else{let n=e.orOperator?"OR":"AND";let r=[t(e.leftChild,n),n,t(e.rightChild,n)];return"AND"==i&&"OR"==n?["(",r,")"]:r}};return Kameleoon.Utils.flatten(t(e,"OR"))};this.processAllTargetingSegments=()=>{const e=Kameleoon.Internals.runtime.targetingSegments||[];e.forEach((e=>{this.segments[e.id]=e}));this.processTargetingSegments(e)};this.processTargetingSegments=e=>{this.checkTargetingSegmentsTargeting(e);let t=[];for(let i=0,n=e.length;i<n;++i){let n=e[i];if(!0===n.targeting)t.push(n)}this.performSegmentsTracking(t)}}checkIfTargetingMustBeComputed(e,t,i){let n=!0===t&&(void 0===e||!1===e&&!0===i);return n}createIterator(e){let t=0;return{hasNext:function(){return t<e.length},next:function(){return e[t++]}}}performSegmentsTracking(e){for(let t=0,i=e.length;t<i;++t){let i=e[t];Kameleoon.Utils.sendKameleoonCustomEvent.call(window,"SegmentTriggered",{segment:{id:i.id,name:i.name}});if(Kameleoon.Internals.configuration.useAudience||i.opportunityDetection||Kameleoon.Internals.runtime.mentalistRun&&(i.trackMentalistPrediction||i.mentalist))Kameleoon.Gatherer.track(VisitEvent_TargetingSegments,{id:i.id});}}}class Tracking{constructor(){this.timeBeforeSendTracking=20*60*1e3;this.checkAndSetKameleoonTrackingTime=(t,e)=>{const n=Kameleoon.Utils.secureSessionStorage("getItem","kameleoonAnalyticsTrackingTimes");const i=null==n?{}:JSON.parse(n);const a="Experiment-"+t;if(null==i[e]||null==i[e][a]||(new Date).getTime()>=i[e][a]+this.timeBeforeSendTracking){if(null==i[e])i[e]={};i[e][a]=(new Date).getTime();Kameleoon.Utils.secureSessionStorage("setItem","kameleoonAnalyticsTrackingTimes",JSON.stringify(i));return!0}return!1};this.obtainTealiumData=()=>{};this.processCustomIntegration=t=>{}}}Tracking.prototype.processGoogleAnalytics4=function(e){let a=Kameleoon.Internals.configuration.googleAnalytics4Gtag;if(a&&window.gtag||0==a&&window.dataLayer||null==a&&window.dataLayer){let n=e.experimentAction?"kameleoon_experiment":"kameleoon_personalization";if((a||null==a)&&window.gtag){let a=`${e.id} - ${e.name} - ${e.associatedVariation.id} - ${e.associatedVariation.name}`;let i={experiment_variation:a,event_timeout:2e3};if(null!=Kameleoon.Internals.configuration.googleAnalytics4MeasurementId)i.send_to=Kameleoon.Internals.configuration.googleAnalytics4MeasurementId;window.gtag("event",n,i)}else if(1!=a&&window.dataLayer)window.dataLayer.push({event:n,campaign_name:e.name,campaign_id:e.id,variation_name:e.associatedVariation.name,variation_id:e.associatedVariation.id})}else Kameleoon.Utils.setTimeout((function(){Kameleoon.Tracking.processGoogleAnalytics4.apply(Kameleoon.Tracking,[e])}),150)};class Variation{constructor(e){this.getAction=()=>Kameleoon.Internals.runtime.Campaigns.obtainCampaign(this.actionId);for(let t in e)this[t]=e[t]}applyJavascriptCode(e){if(this.javaScriptCode&&this.javaScriptCode.code&&(null==this.javaScriptCode.evaluated||e)){this.javaScriptCode.evaluated=!0;return Kameleoon.Utils.runProtectedScript(this.javaScriptCode.code,"kameleoonVariationJavaScriptCode-"+this.id+".js")}return null}preProcessRedirect(e){}process(){const e=Kameleoon.Internals.runtime.Campaigns.obtainCampaign(this.actionId);if(this.redirections&&!Kameleoon.Internals.runtime.editorEnabled)this.preProcessRedirect(e);if(this.forceNoFlicker&&!Kameleoon.Internals.runtime.domReady){var t="";for(var o=0,n=this.elementSets.length;o<n;++o)t+=(0!=o?", ":"")+this.elementSets[o].selector;Kameleoon.Utils.forceNoFlicker(t)}if(!this.styleSheetAdded){this.styleSheetAdded=!0;Kameleoon.Utils.addCSSStyleSheet(this.css,e,null)}if(this.javaScriptCode&&!this.permanentRefreshActive)if(!this.javaScriptCode.afterDOMReady)this.applyJavascriptCode(!1);else if(!this.permanentRefreshActive)Kameleoon.Utils.domReady((()=>{this.applyJavascriptCode(!1)}));if(this.forceNoFlicker&&!this.permanentRefreshActive)Kameleoon.Utils.removeBlockingStyleSheet();if(Kameleoon.Internals.runtime["enginePollerForVariation"+this.id]&&!this.permanentRefreshActive){if(Kameleoon.Internals.runtime.cantUseMutationObserver)Kameleoon.Utils.clearInterval(Kameleoon.Internals.runtime["enginePollerForVariation"+this.id]);Kameleoon.Internals.runtime["enginePollerForVariation"+this.id]=null}if(!Kameleoon.Internals.runtime["enginePollerForVariation"+this.id]&&!Kameleoon.Internals.runtime.editorMode&&!Kameleoon.Internals.runtime.kameleoonSelectionIframeMode){this.permanentRefreshActive=!0;Kameleoon.Internals.runtime.listenVariations.push(this);Kameleoon.Internals.runtime["enginePollerForVariation"+this.id]=!0;if(Kameleoon.Internals.runtime.cantUseMutationObserver)Kameleoon.Internals.runtime["enginePollerForVariation"+this.id]=Kameleoon.Utils.setInterval((()=>{this.process()}),10)}}processReplaceData(e){}}class Visit{constructor(e){this.addActionTriggered=(e,t)=>{if(t){let t=Kameleoon.Internals.runtime.storedData.obtainField("Gatherer","experimentsTriggered",{});t[e.toString()]=!0;Kameleoon.Internals.runtime.storedData.saveField("Gatherer","experimentsTriggered",t)}else{let t=Kameleoon.Internals.runtime.storedData.obtainField("Gatherer","personalizationsTriggered",{});t[e.toString()]=!0;Kameleoon.Internals.runtime.storedData.saveField("Gatherer","personalizationsTriggered",t)}};this.addActivity=(e,t)=>{if(t)this.lastActivityDate=e};this.addAdBlocker=()=>{this.Device.adBlocker=!0};this.addConversions=(e,t,i,s)=>{let n=s?-1:1;t*=n;i*=n;let a=this.conversions[e];let r=a?a.count:0;let o=a?a.revenue:0;let l=r+t;let u=o+i;if(l>0)if(u>=0)this.conversions[e]={count:l,revenue:u};else delete this.conversions[e];else delete this.conversions[e]};this.addCustomData=(e,t,i)=>{if(Kameleoon.Utils.testEmptyMap(t)){if(i)delete this.customData[e]}else{if(i||null==this.customData[e])this.customData[e]={};for(let i in t)this.customData[e][i]=(this.customData[e][i]||0)+t[i]}};this.addExperiment=(e,t,i)=>{};this.addGeolocation=(e,t,i,s,n,a)=>{this.Geolocation={country:e,region:t,city:i,postalCode:s,latitude:n,longitude:a}};this.addNumberClicks=e=>{if(e>0)this.clicks+=e};this.addPage=(e,t,i,s)=>{this.addActivity(e,!0);let n=s.filter((e=>null!=e));this.pages.push({timestamp:e,keyPagesMatched:i,referrersMatched:n.length>0?n:[]});let a=this.pageURLsVisited[t];if(null==a){a=[];this.pageURLsVisited[t]=a}a.push(e);for(let e in this.productEansLastPage)this.productEansAllButLastPages[e]=!0;this.productEansLastPage={}};this.addPersonalization=(e,t,i)=>{};this.addProduct=e=>{this.productEansLastPage[e]=!0};this.addTargetingSegment=(e,t)=>{let i=this.activatedSegments[t];if(null==i){i=[];this.activatedSegments[t]=i}i.push(e)};this.addWeather=e=>{this.Weather=e};this.clearCustomDataPage=()=>{for(let e in Kameleoon.Internals.runtime.Gatherer.configuration.customData){let t=Kameleoon.Internals.runtime.Gatherer.configuration.customData[e];if("PAGE"==t.scope)delete this.customData[e]}};this.computeActionNumberActivations=(e,t,i,s)=>{if(null==s[e])return 0;return this.computeObjectNumberPresence(t,i,s[e].times)};this.computeObjectNumberPresence=(e,t,i)=>{let s=0;for(let n=0,a=i.length;n<a;++n){let a=i[n];if((null==e||a>=e)&&(null==t||a<=t))s++}return s};this.convertVisitFromServer=()=>this;this.isVisitFinished=()=>this.lastActivityDate<(new Date).getTime()-Kameleoon.Internals.runtime.Gatherer.configuration.maxVisitIdleDuration;this.obtainKeyPageIsVisited=e=>{let t=this.pages.filter((t=>-1!=t.keyPagesMatched.indexOf(e)));return t.length>0};this.obtainMeanPageDuration=()=>{let e=new Date;let t=this.obtainTimesStartedPages();let i=OnlineMeanAndDeviation.createFromDifferences(t,!1,!0,!0);i.update([e.getTime()-t[t.length-1]]);return i.mean[0]};this.obtainNumberConversions=e=>{let t=this.conversions[e];return null==t?0:t.count};this.obtainPageNumberViews=(e,t,i,s)=>{let n=0;for(let a in this.pageURLsVisited)if(null!=a){let r=Kameleoon.Utils.computeRelativeURL(a);if((null==e||e.test(a)||e.test(r))&&(null==t||!t.test(a)&&!t.test(r)))n+=this.computeObjectNumberPresence(i,s,this.pageURLsVisited[a])}return n};this.obtainTimesStartedPages=()=>{let e=[];for(let t in this.pageURLsVisited)e.concat(this.pageURLsVisited[t]);return e.sort()};this.obtainPersonalizationNumberActivations=(e,t,i)=>this.computeActionNumberActivations(e,t,i,this.PersonalizationActivations);this.obtainReferrerIsPresent=e=>{let t=null==e?null:e+1;let i=this.pages.filter((e=>-1!=e.referrersMatched.indexOf(t)));return i.length>0};this.visitNumber=e.visitNumber||e.index||0;this.landingPageURL=e.landingPageURL||null;this.productEansAllButLastPages=e.productEansAllButLastPages||{};this.productEansLastPage=e.productEansLastPage||{};this.startDate=e.startDate||0;this.pageURLsVisited=e.pageURLsVisited||e.timesByPageHref||{};this.activatedSegments=e.activatedSegments||e.timesByTargetingSegmentId||{};this.visitorCode=e.visitorCode||"";this.customData=e.countByValueByCustomDatum||e.customData||{};this.clicks=e.clicks||e.numberClicks||0;this.lastActivityDate=e.lastActivityDate||e.timeLastActivity||this.startDate;let t=e.Device||{};this.Device={adBlocker:t.adBlocker||!1,browser:t.browser||"Other",browserVersion:t.browserVersion||null,os:t.os||"Other",screenHeight:t.screenHeight||null,screenWidth:t.screenWidth||null,timeZone:t.timeZone||"UTC",type:t.type?t.type.toLocaleUpperCase():null,windowHeight:t.windowHeight||null,windowWidth:t.windowWidth||null};let i=e.Geolocation||{};this.Geolocation={city:i.city||null,country:i.country||null,latitude:i.latitude||null,longitude:i.longitude||null,postalCode:i.postalCode||null,region:i.region||null};let s=e.Weather||{};this.Weather={conditionCode:s.conditionCode||null,conditionDescription:s.conditionDescription||null,cloudiness:s.cloudiness||null,humidity:s.humidity||null,pressure:s.pressure||null,sunrise:s.sunrise||null,sunset:s.sunset||null,temperature:s.temperature||null,windSpeed:s.windSpeed||null};this.conversions=e.conversions||{};this.ExperimentActivations=e.ExperimentActivations||{};this.PersonalizationActivations=e.PersonalizationActivations||{};this.pages=e.pages||[];if(e.keyPages){let t=this.obtainTimesStartedPages();e.keyPages.forEach(((i,s)=>{let n=t[s];let a=e.timesReferrers.indexOf(n);let r=-1!=a?e.referrers[a]:[];this.pages.push({timestamp:n,keyPagesMatched:i,referrersMatched:r})}));delete e.timesReferrers;delete e.referrers;delete e.keyPages}if(e.experimentInfluences){for(let t in e.experimentInfluences)if(this.ExperimentActivations[t])this.ExperimentActivations[t].influence=e.experimentInfluences[t][1];delete e.experimentInfluences}if(e.personalizationInfluences){for(let t in e.personalizationInfluences)if(this.PersonalizationActivations[t])this.PersonalizationActivations[t].influence=e.personalizationInfluences[t][1];delete e.personalizationInfluences}if(null!=e.Device.browserName){this.Device.browser=e.Device.browserName;delete e.Device.browserName}if(null!=e.Device.osName){this.Device.os=e.Device.osName;delete e.Device.osName}}obtainExperimentNumberActivations(e,t,i){return this.computeActionNumberActivations(e,t,i,this.ExperimentActivations)}}class Visitor{constructor(){this.addVisit=e=>{this.visits.push(e);this.currentVisit=e;this.totalVisits++;if(null==this.timeStartedEldestVisit)this.timeStartedEldestVisit=e.startDate;let t=this.visits.length;let i=Math.max(1,Kameleoon.Internals.configuration.maxNumberLocalVisits);if(t>i)this.visits=this.visits.slice(t-i)};this.addPreviousVisits=e=>{if(null!=this.currentVisit){let t=this.currentVisit;let i=[];for(let e=0,t=this.visits.length-1;e<t;++e)i.push(this.visits[e]);for(let t=0,s=e.length;t<s;++t)i.push(e[t]);i.sort(((e,t)=>{let i=e.startDate-t.startDate;if(0!=i)return i;i=e.visitNumber-t.visitNumber;return i}));let s=null;let o=null;for(let e=0,t=i.length;e<t;e++){let t=i[e];let n=t.visitorCode;let r=t.visitNumber;if(n!=s||r!=o)this.addVisit(t);s=n;o=r}this.addVisit(t)}};this.obtainKeyPageIsVisited=e=>{for(let t=0,i=this.visits.length;t<i;++t)if(this.visits[t].obtainKeyPageIsVisited(e))return!0;return!1};this.obtainReferrerIsPresent=e=>{for(let t=0,i=this.visits.length;t<i;++t)if(this.visits[t].obtainReferrerIsPresent(e))return!0;return!1};this.obtainNumberConversions=e=>{let t=0;for(let i=this.visits.length-1;i>=0;--i)t+=this.visits[i].obtainNumberConversions(e);return t};this.obtainActionNumberActivations=(e,t,i,s,o,n,r,a)=>{let l=a?"obtainExperimentNumberActivations":"obtainPersonalizationNumberActivations";let m=Kameleoon.Internals.runtime.Visitor.visits.length;let u=0;if(m>0){if(o){let t=Kameleoon.Internals.runtime.Visitor.visits[m-1][l](e,i,s);u+=r?t>0?1:0:t}if(n)for(let t=0,o=m-1;t<o;++t){let o=this.visits[t][l](e,i,s);u+=r?o>0?1:0:o}}return u};this.obtainPageNumberViews=(e,t,i,s,o,n)=>{let r=this.visits.length;let a=0;if(r>0){if(o)a+=this.visits[r-1].obtainPageNumberViews(e,t,i,s);if(n)for(let o=0,n=r-1;o<n;++o)a+=this.visits[o].obtainPageNumberViews(e,t,i,s)}return a};this.obtainTimeSincePreviousVisit=()=>{let e=0;if(this.visits.length>1){e=this.currentVisit.startDate-this.visits.slice(-2)[0].lastActivityDate;e=Math.max(e,Kameleoon.Internals.runtime.Gatherer.configuration.maxVisitIdleDuration)}return e};this.obtainVisitorCode=e=>{let t=!1;let i;let s=Kameleoon.Utils.readLocalData("kameleoonVisitorCode","COOKIE");const o=Kameleoon.Internals.runtime.storedData.obtainField("Gatherer","timeNextSynchronization",null);if(s)s=s.replace("_js_","");i=s;if(Kameleoon.Internals.configuration.useWideDomainSupport||Kameleoon.Internals.configuration.useVisitorCodeInLocalStorage){let e=Kameleoon.Internals.runtime.incomingStoredData?Kameleoon.Internals.runtime.incomingStoredData.kameleoonVisitorCode:Kameleoon.Utils.readLocalData("kameleoonVisitorCode","LS");if(e)i=e}if(e||null==i){i=Kameleoon.Utils.obtainRandomString(Visitor.VISITOR_CODE_LENGTH,Analyst.CODE_ALPHABET);t=!0}Kameleoon.Utils.saveVisitorCode(i,null==o);this.visitorCode=i;return t};this.obtainVisitorFromStoredData=()=>Kameleoon.Internals.runtime.storedData.Visitor;this.saveToStoredData=()=>{this.saveFieldToStoredData("visits",this.visits);this.saveFieldToStoredData("totalVisits",this.totalVisits);this.saveFieldToStoredData("timeStartedEldestVisit",this.timeStartedEldestVisit)};this.setVisitorCode=e=>{if(this.visitorCode!=e){Kameleoon.Internals.runtime.newVisitorCode=!0;Kameleoon.Utils.saveVisitorCode(e);this.visitorCode=e;Kameleoon.Internals.runtime.Visitor.currentVisit.visitorCode=e;if(this.visits)this.visits.forEach((t=>{t.visitorCode=e}));Kameleoon.Internals.runtime.Campaigns.obtainCampaignsList("experiments").forEach((e=>{if(void 0!==e.registeredVariationId){e.registeredVariationId=void 0;e.performVariationAssignment(!0)}}));this.saveToStoredData();Kameleoon.Gatherer.track(VisitEvent_Page);Kameleoon.Gatherer.track(VisitEvent_StaticData)}};this.updateCurrentVisit=()=>{};this.updateFromStoredData=(e,t,i)=>{let s=!1;let o=this.obtainVisitorFromStoredData();let n=o.visits;if(!this.visitorCode){let e=this.obtainVisitorCode(i);if(e)i=!0}if(n){let e=n.slice(-1)[0].visitorCode;if(e!=this.visitorCode){let t=Kameleoon.Utils.readLocalData("kameleoonVisitorCode","LS");if(t==e||!Kameleoon.Internals.runtime.Consent.hasGlobalConsent()){this.visitorCode=e;try{delete Kameleoon.Internals.runtime.localDataMap.COOKIE.kameleoonVisitorCode;delete Kameleoon.Internals.runtime.localDataMap.LS.kameleoonVisitorCode}catch(e){}}else if(t==this.visitorCode)i=!0}}if(i||e){t=!0;if(i)this.totalVisits=0}this.visits=[];if(!i&&n){n.forEach((e=>{this.addVisit(new Visit(e))}));this.totalVisits=o.totalVisits;this.timeStartedEldestVisit=o.timeStartedEldestVisit}let r=!1;if(t||!this.currentVisit||this.currentVisit.isVisitFinished()){let e=Kameleoon.Internals.runtime.storedData.obtainField("Gatherer","startsOfVisitForCurrentPage");Kameleoon.Internals.runtime.storedData.saveField("Gatherer","startsOfVisitForCurrentPage",e+1);Kameleoon.Internals.runtime.Gatherer.startOfVisit=s=!0;Kameleoon.Internals.runtime.storedData.resetForStartOfVisit();Kameleoon.Internals.runtime.storedData.saveField("Runtime","firstReferrerHref",Kameleoon.Gatherer.Referrer.obtainCorrected(!0)||null);Kameleoon.Internals.runtime.storedData.saveField("Runtime","firstReferrersIndices",Kameleoon.Gatherer.Referrer.obtainIndexes(!0)||[null]);Kameleoon.Internals.runtime.storedData.saveField("Runtime","landingKeyPagesIndices",Kameleoon.Gatherer.KeyPage.obtainIndexes()||[null]);let t;if(!this.currentVisit||i)t=0;else t=this.currentVisit.visitNumber+1;this.addVisit(new Visit({visitorCode:this.visitorCode,startDate:(new Date).getTime(),visitNumber:t,landingPageURL:Kameleoon.Utils.computeCurrentPageCleanAbsoluteURL(),Device:{browser:Kameleoon.Gatherer.Browser.obtain(),browserVersion:Kameleoon.Internals.runtime.Device.browserVersion,os:Kameleoon.Gatherer.OperatingSystem.obtain(),screenHeight:Kameleoon.Internals.runtime.Device.screenHeight,screenWidth:Kameleoon.Internals.runtime.Device.screenWidth,timeZone:Kameleoon.Gatherer.TimeZone.obtainId(),type:Kameleoon.Internals.runtime.Device.type,windowHeight:Kameleoon.Internals.runtime.Device.windowHeight,windowWidth:Kameleoon.Internals.runtime.Device.windowWidth}}));r=!0}this.saveToStoredData();Kameleoon.Internals.runtime.storedData.save(r)};this.trackInfluences=()=>{if(Kameleoon.Internals.runtime.Gatherer.startOfVisit&&this.visits.length>1)Kameleoon.Gatherer.track(VisitEvent_StaticData)};this.getCustomDataVisitor=()=>{let e={};let t=Kameleoon.Internals.runtime.Gatherer.configuration.customData;for(let i in Kameleoon.Internals.runtime.Visitor.currentVisit.customData){let s=t[i];if(null!=s&&!s.disabled)if("VISITOR"==s.scope){let t=Kameleoon.Internals.runtime.Visitor.currentVisit.customData[i];e[i]=t}}return e};this.registerVisitsRequestSuccessAndChangePreviousVisits=e=>{};this.compareCurrentVisitFromServer=e=>{};this.performRemoteVisitorSynchronization=()=>{};this.obtainProductData=(e,t,i,s)=>{};this.visits=[];this.currentVisit=null;this.totalVisits=0;this.updateFromStoredData(!1);Object.defineProperty(this,"customData",{enumerable:!0,get:()=>this.getCustomDataVisitor()});}saveFieldToStoredData(e,t){Kameleoon.Internals.runtime.storedData.Visitor[e]=t}remoteSynchronisation(e,t,i,s){}}Visitor.VISITOR_CODE_LENGTH=16;Visitor.INFLUENCE_DELAY=1e3*60*60*24*7;try{window.Kameleoon=new KameleoonEngine}catch(o){console.log(o)}
Kameleoon.Internals = {"configuration":{"API_HOST_NAME":"api","APP_HOST_NAME":"app","BACK_OFFICE_HOST_NAME":"old","BASE_EDITOR_URL":"//static.kameleoon.com/js/editor/","EDITOR_HOST_NAME":"editor","DOMAIN":"kameleoon.com","WIDE_DOMAIN":"kameleoon.eu","GUI_ESTIMATED_LOADING_TIME":3000,"IMAGE_PATH":"https://hugi3bzk9v.kameleoon.eu/images/","PROXY_HOST_NAME":"proxy","QOOXDOO_ESTIMATED_LOADING_TIME":2000,"SERVER_CALL_ESTIMATED_LOADING_TIME":500,"STATIC_DIRECT_HOST_NAME":"static-direct","STATIC_HOST_NAME":"static","VISITOR_DOMAIN":"kameleoon.io","environment":"PRODUCTION","staticURL":"//static.kameleoon.eu/","maxNumberLocalVisits":25,"memberCode":"0","siteCode":"hugi3bzk9v","abtestConsent":"REQUIRED","abtestConsentOptout":"RUN","beforeAbtestConsent":"ALL","beforePersonalizationConsent":"ALL","personalizationConsent":"OFF","personalizationConsentOptout":"RUN","personalizationsDeviation":1,"experiments":[],"personalizations":[],"targetingSegments":[],"variations":[{"id":0,"name":"Reference","css":"","elementSets":[]},{"id":null,"name":"Excluded"}],"goals":[{"id":305638,"name":"Retention rate","type":"ENGAGEMENT"},{"id":306974,"name":"Interaction Widget","type":"CUSTOM"},{"id":307492,"name":"revenu","type":"CUSTOM"},{"id":307651,"name":"[KAM] - Ajouter au panier","type":"CLICK"},{"id":307653,"name":"[KAM] - Continuer le shopping","type":"CLICK"},{"id":307659,"name":"[KAM] -  PLP click on product","type":"CLICK"},{"id":307669,"name":"Clic promo header","type":"CLICK"},{"id":307673,"name":"Clic description mobile","type":"CLICK"},{"id":307695,"name":"[KAM] - Accès page panier","type":"URL","url":"(.*)panier(.*)"},{"id":307701,"name":"PLP - clic affichage 3 cartouches","type":"CLICK"},{"id":307829,"name":"Mobile - clic classer par PLP","type":"CLICK"},{"id":308085,"name":"Scroll 60%","type":"SCROLL","scrollTrackingType":"PERCENTAGE","scrollTrackingValue":60},{"id":308121,"name":"PLP - Click on filter","type":"CLICK"},{"id":308142,"name":"[KAM] AddToCart","type":"CUSTOM"},{"id":308144,"name":"PDP - clic caracteristiques","type":"CLICK"},{"id":308278,"name":"[KAM] Taux de rebond","type":"CUSTOM"},{"id":308283,"name":"[KAM] revenu","type":"CUSTOM"},{"id":308285,"name":"[KAM] Nombre articles","type":"CUSTOM"},{"id":308960,"name":"Internal search - click gender (API)","type":"CUSTOM"},{"id":310527,"name":"mobile - CTA filter","type":"CLICK"},{"id":310528,"name":"Mobile - click TRI","type":"CLICK"},{"id":312162,"name":"Internal search - search submit (API)","type":"CUSTOM"},{"id":312442,"name":"Internal search - click on autocomplete product (API)","type":"CUSTOM"},{"id":312460,"name":"Listing search - click on product","type":"CLICK"},{"id":312467,"name":"Nombre de PDP vues","type":"URL","url":"(.*)/p/(.*)"},{"id":314947,"name":"Internal search - click on top brands (API)","type":"CUSTOM"},{"id":316318,"name":"[KAM] Nombre d'achats finalisés","type":"CUSTOM"},{"id":316821,"name":"listing - filtres bloc offres nb clics (API)","type":"CUSTOM"},{"id":316856,"name":"Temps passé moyen - 1min30","type":"TIME_SPENT","minTimeSpent":90001},{"id":317907,"name":"breadcrumb nav click - mobile - listing (API)","type":"CUSTOM"},{"id":317910,"name":"Mobile listing - clic modale filters (API)","type":"CUSTOM"},{"id":318981,"name":"[API] cross-sell banner click cart","type":"CUSTOM"},{"id":318988,"name":"[API] cross sell banner cart view","type":"CUSTOM"},{"id":319636,"name":"[KAM] Taux de sortie","type":"CUSTOM"},{"id":319927,"name":"[API] cross-sell banner click PDP","type":"CUSTOM"},{"id":320358,"name":"TEST OBJ BANNIERE REDIRECT","type":"CUSTOM"},{"id":325451,"name":"[API] listing click product PROMO","type":"CUSTOM"},{"id":325453,"name":"[API] Add to cart si produit en PROMO","type":"CUSTOM"},{"id":325454,"name":"[API] cross-sell si produit en PROMO","type":"CUSTOM"},{"id":325455,"name":"[API] Search bar - click produit suggéré/nouveauté en PROMO","type":"CUSTOM"}],"scriptProduceTime":1704811262024,"timeZone":"Europe/Paris","abtestingSetup":true,"personalizationSetup":true,"boLocale":"FRENCH","trackerContinent":"","DATA_URL":"https://data.kameleoon.io","useMultipleSiteCodes":true,"useOpportunitySegments":true,"googleAnalytics4":true,"globalScript":"class GlobalScript{constructor(){this.DEBUG=!(!window.localStorage.getItem(\"kam-support\")&&!/kam.*-support/.test(document.cookie)),this.goals={},this.customData={},this.convertGoal={},this.regexp={},this.utils={},this.setCustomData(),this.setRegexp(),this.setGoals(),this.setUtils(),console.info(\"[Sitecode]\",Kameleoon.Internals.configuration.siteCode),console.info(\"[Script Last Update]\",new Date(Kameleoon.Internals.configuration.scriptProduceTime).toLocaleString()),this.init()}setRegexp(){const e=\"(https://colizey.fr)(?:/)?\",o=\"(?:/)?([?$#][[]%;,?:@&=+$-_.!~*'\\\"()#a-zA-Z0-9]*)?$\",t={homepage:e+o,platform:e+\"(plateforme|platform|piattaforma|plattform)\"+o,panier:\"/panier\",livraison:\"/achat/livraison\",paiement:\"/achat/paiement\",confirmation:\"/achat/recapitulatif\"};for(const e in t)this.regexp[e]=new RegExp(t[e])}setGoals(){const e=this;this.goals={taux_de_rebond:308278,\"[KAM]_revenu\":308283,nombre_articles:308285,addToCart:308142,\"[KAM]_Nombre_achats_finalises\":316318,\"[KAM]_Taux_de_sortie\":319636,productInCartList:[{id:307681,name:\"[KAM] - Nombre de produits par achat\",url:e.regexp.panier,className:\".cart-product\"}]},this.convertGoal={productInCart(){window.location.href.includes(e.goals.productInCartList.url)&&Kameleoon.API.Core.runWhenElementPresent(e.goals.productInCartList.className,(o=>{let t=o.length;Kameleoon.API.Goals.processConversion(e.goals.productInCartList.id,t)}))},convertBounceRateGoalFunction(){Kameleoon.API.Goals.processConversion(e.goals.taux_de_rebond),window.addEventListener(\"click\",(()=>{Kameleoon.API.Goals.cancelConversion(e.goals.taux_de_rebond)}),{once:!0})},orderConfirmationJuly(){if(window.location.href.match(e.regexp.confirmation)){let o,t;Kameleoon.API.Core.runWhenConditionTrue((()=>(o=window?.dataLayer?.find((e=>null!=e?.ecommerce))?.ecommerce,t=window?.dataLayer?.find((e=>null!=e?.ecommerce))?.ecommerce?.items,!!o&&t)),(()=>{const n=parseFloat(o.value),i=t.length;Kameleoon.API.Data.setCustomData(\"Nombre_articles_achetes\",i),Kameleoon.API.Goals.processConversion(e.goals[\"[KAM]_revenu\"],n),Kameleoon.API.Goals.processConversion(e.goals.nombre_articles,i),Kameleoon.API.Goals.processConversion(e.goals[\"[KAM]_Nombre_achats_finalises\"],n)}))}},addToCart(){const o=()=>Kameleoon.API.Core.runWhenElementPresent(\"#add-to-cart-master\",(([o])=>{Kameleoon.API.Utils.addEventListener(o,\"click\",(()=>{Kameleoon.API.Core.runWhenElementPresent(\".ccontent .modal__container--active .modal\",(([o])=>{Kameleoon.API.Goals.processConversion(e.goals.addToCart)}),100)}),{once:!0})}),100);o(),Kameleoon.API.Core.runWhenElementPresent(\".ccontent\",(([e])=>{Kameleoon.API.Utils.addEventListener(e,\"click\",(e=>{e.target.closest(\"#modal-shopping .modal__close\")&&o()})),Kameleoon.API.Utils.addEventListener(e,\"mousedown\",(e=>{!e.target.closest(\"#modal-shopping .modal\")&&e.target.closest(\"#modal-shopping\")&&o()}))}),100)},outRate(){window.location.href.match(e.regexp.livraison)&&!sessionStorage.getItem(\"outRate\")?(Kameleoon.API.Goals.processConversion(e.goals[\"[KAM]_Taux_de_sortie\"]),sessionStorage.setItem(\"outRate\",\"taux_de_sortie\")):window.location.href.match(e.regexp.confirmation)&&Kameleoon.API.Goals.cancelConversion(e.goals[\"[KAM]_Taux_de_sortie\"])},basedOnURL(e){e.forEach((e=>{e.regex.test(window.location.href)&&Kameleoon.API.Goals.processConversion(e.id)}))}}}setCustomData(){this.customData={setMyCustomData(){Kameleoon.API.Data.setCustomData(\"myCustomData\",!0)}}}setUtils(){const e=this;this.utils={conversionObserver(){e.DEBUG&&Kameleoon.API.Utils.addEventListener(window,\"Kameleoon::ConversionTriggered\",(o=>{e.log(`the goal \"${o.detail.name}\" (${o.detail.id}) converted`)}))},handleConsent(){Kameleoon.API.Core.runWhenConditionTrue((()=>void 0!==window._axcb),(()=>{void 0===window._axcb&&(window._axcb=[]),window._axcb.push((function(e){e.on(\"cookies:complete\",(function(e){console.log(e),!0===e.kameleoon?(Kameleoon.API.Core.enableLegalConsent(\"BOTH\"),console.log(\"enableLegalConsent\")):!1!==e.kameleoon&&null!=e.kameleoon||(Kameleoon.API.Core.disableLegalConsent(\"BOTH\"),console.log(\"disableLegalConsent\"))}))}))}))}}}runFirst(){}runLast(){}log(){this.DEBUG&&console.log(\"[Kameleoon DEBUG]\",...arguments)}init(){try{this.runFirst(),this.utils.handleConsent(),this.convertGoal.productInCart(),this.convertGoal.convertBounceRateGoalFunction(),this.convertGoal.orderConfirmationJuly(),this.convertGoal.addToCart(),this.convertGoal.outRate(),this.runLast()}catch(e){this.DEBUG?console.error(e):console.log(\"[Kameleoon Global Script Error]\")}}}const globalScript=new GlobalScript;try{var kameleoonEventsTracker=[{id:307651,selector:\".product-page__add-basket\"},{id:307653,selector:\"#continue\"},{id:307659,selector:\"[data-listing-category='listing category'] .cproduct\"},{id:307669,selector:\"#menu > div:nth-of-type(11) > a:first-child\"},{id:307673,selector:\"#body-wrapper > div:nth-of-type(5) > div:nth-of-type(3) > section:nth-of-type(1) > div:nth-of-type(3) > div:nth-of-type(2) > div:first-child > div:first-child > div:first-child\"},{id:307701,selector:\"#body-wrapper > div:nth-of-type(5) > div:first-child > div:first-child > div:first-child > div:nth-of-type(1) > div:nth-of-type(2) > div:nth-of-type(1) > div:first-child > div:first-child > button:first-child > div:nth-of-type(2)\"},{id:307829,selector:\"#body-wrapper > div:nth-of-type(5) > div:first-child > div:first-child > div:first-child > div:nth-of-type(1) > div:nth-of-type(2) > div:nth-of-type(1) > div:nth-of-type(3) > div:first-child > div:nth-of-type(2)\"},{id:308121,selector:\".cgrid__listing__filters.cfilters\"},{id:308144,selector:'[id=\"product-content\"] + div > div:first-child > div:first-child + div > div:first-child > span:first-child + h2'},{id:310527,selector:\"[data-listing-category='listing category'] .cgrid__listing__controls pb-h\"},{id:310527,selector:\".cfilters__button\"},{id:310528,selector:\"#body-wrapper > div:nth-of-type(5) > div:first-child > div:first-child > div:nth-of-type(2) > div:nth-of-type(1) > div:first-child > div:nth-of-type(2) > div:nth-of-type(3) > div:first-child > div:nth-of-type(2)\"},{id:312460,selector:\"[data-listing-category='listing search'] .cproduct\"}],createEventTracking=function(e,o){for(var t,n=function(e){Kameleoon.Internals.runtime.touchMoveEvent||Kameleoon.API.Goals.processConversion(o.id)},i=0;i<e.length;++i)t=e[i],Kameleoon.Utils.addEventListener(t,Kameleoon.Internals.runtime.mouseDownEvent,n,!0)},kameleoonTimeoutId=Kameleoon.Utils.setTimeout((function(){Kameleoon.Utils.clearTimeout(kameleoonTimeoutId),kameleoonEventsTracker.forEach((e=>{Kameleoon.API.Core.runWhenElementPresent(e.selector,(o=>{createEventTracking(o,e)}),null,Kameleoon.Internals.runtime.singlePageSupport)}))}),250)}catch(e){console.log(\"An error occurred in your custom JavaScript Kameleoon tracking function, please check your code.\"),console.log(e,e.message)}","track":true,"trackerExcludedIPRanges":[],"Gatherer":"eyJtYXhWaXNpdElkbGVEdXJhdGlvbiI6MTgwMDAwMCwiZGlyZWN0Tm9uZVJlZmVycmVyT25seUZpcnN0IjpmYWxzZSwiYnJvd3NlcnMiOnsiMCI6eyJuYW1lIjoiQ0hST01FIn0sIjEiOnsibmFtZSI6IkVYUExPUkVSIn0sIjIiOnsibmFtZSI6IkZJUkVGT1gifSwiMyI6eyJuYW1lIjoiU0FGQVJJIn0sIjQiOnsibmFtZSI6Ik9QRVJBIn19LCJvc3MiOnsiMCI6eyJuYW1lIjoiV0lORE9XUyJ9LCIxIjp7Im5hbWUiOiJNQUMifSwiMiI6eyJuYW1lIjoiSU9TIn0sIjMiOnsibmFtZSI6IkxJTlVYIn0sIjQiOnsibmFtZSI6IkFORFJPSUQifSwiNSI6eyJuYW1lIjoiV0lORE9XUyBQSE9ORSJ9fSwibm9SZWZlcnJlclBhZ2VzIjpbXSwicmVmZXJyZXJzIjp7IjAiOnsibmFtZSI6Ikdvb2dsZSBBZFdvcmRzIiwicHJpb3JpdHkiOjAsImRldGVjdGlvbnMiOlt7ImFuZE1ldGhvZCI6IiIsIm1ldGhvZCI6IlJFRkVSUkVSX1JFR0VYIiwiYW5kIjpmYWxzZSwiYW5kUGFyYW1ldGVycyI6IiIsInBhcmFtZXRlcnMiOiJeLitcXFxcLmdvb2dsZShcXFxcLmNvbT8pP1xcXFwuW14vXFxcXC5dKy9hY2xrKFtcXFxcPyYjXS4qfCkkIn0seyJhbmRNZXRob2QiOiIiLCJtZXRob2QiOiJVUkxfUkVHRVgiLCJhbmQiOmZhbHNlLCJhbmRQYXJhbWV0ZXJzIjoiIiwicGFyYW1ldGVycyI6IltcXFxcPyYjXWdjbGlkPSJ9XX0sIjEiOnsibmFtZSI6Ikdvb2dsZSBPcmdhbmljIFNlYXJjaCIsInByaW9yaXR5IjowLCJkZXRlY3Rpb25zIjpbeyJhbmRNZXRob2QiOiIiLCJtZXRob2QiOiJSRUZFUlJFUl9SRUdFWCIsImFuZCI6ZmFsc2UsImFuZFBhcmFtZXRlcnMiOiIiLCJwYXJhbWV0ZXJzIjoiXi4rXFxcXC5nb29nbGUoXFxcXC5jb20/KT9cXFxcLlteL1xcXFwuXSsvKD8hYWNsa3xpbWdyZXMpLipbXFxcXD8mI11xPS4qKFtcXFxcPyYjXS4qfCkkIn0seyJhbmRNZXRob2QiOiIiLCJtZXRob2QiOiJSRUZFUlJFUl9SRUdFWCIsImFuZCI6ZmFsc2UsImFuZFBhcmFtZXRlcnMiOiIiLCJwYXJhbWV0ZXJzIjoiXi4rXFxcXC5nb29nbGUoXFxcXC5jb20/KT9cXFxcLlteL1xcXFwuXSsvPyQifV19LCIyIjp7Im5hbWUiOiJCaW5nIE9yZ2FuaWMgU2VhcmNoIiwicHJpb3JpdHkiOjAsImRldGVjdGlvbnMiOlt7ImFuZE1ldGhvZCI6IiIsIm1ldGhvZCI6IlJFRkVSUkVSX1JFR0VYIiwiYW5kIjpmYWxzZSwiYW5kUGFyYW1ldGVycyI6IiIsInBhcmFtZXRlcnMiOiJeLitcXFxcLmJpbmdcXFxcLlteL1xcXFwuXSsvLipbXFxcXD8mI11xPS4qKFtcXFxcPyYjXS4qfCkkIn1dfSwiMyI6eyJuYW1lIjoiWWFob28gT3JnYW5pYyBTZWFyY2giLCJwcmlvcml0eSI6MCwiZGV0ZWN0aW9ucyI6W3siYW5kTWV0aG9kIjoiIiwibWV0aG9kIjoiUkVGRVJSRVJfUkVHRVgiLCJhbmQiOmZhbHNlLCJhbmRQYXJhbWV0ZXJzIjoiIiwicGFyYW1ldGVycyI6Il4uK1xcXFwueWFob29cXFxcLlteL1xcXFwuXSsvLipbXFxcXD8mI11wPS4qKFtcXFxcPyYjXS4qfCkkIn1dfSwiNCI6eyJuYW1lIjoiQmFpZHUgT3JnYW5pYyBTZWFyY2giLCJwcmlvcml0eSI6MCwiZGV0ZWN0aW9ucyI6W3siYW5kTWV0aG9kIjoiIiwibWV0aG9kIjoiUkVGRVJSRVJfUkVHRVgiLCJhbmQiOmZhbHNlLCJhbmRQYXJhbWV0ZXJzIjoiIiwicGFyYW1ldGVycyI6Il4uK1xcXFwuYmFpZHVcXFxcLlteL1xcXFwuXSsvLipbXFxcXD8mI113ZD0uKihbXFxcXD8mI10uKnwpJCJ9XX19LCJrZXlQYWdlcyI6e30sImN1c3RvbURhdGEiOnsiMCI6eyJtZXRob2QiOiJDTElFTlQiLCJuYW1lIjoiaGVhZGVyX25hdl9pdGVtIiwiZm9ybWF0IjotMSwic2NvcGUiOiJQQUdFIiwidHlwZSI6IlVOSVFVRSJ9LCIxIjp7Im1ldGhvZCI6IkNMSUVOVCIsIm5hbWUiOiJOb21icmVfYXJ0aWNsZXNfYWNoZXRlcyIsImZvcm1hdCI6LTEsInNjb3BlIjoiVklTSVQiLCJ0eXBlIjoiTElTVCJ9LCIyIjp7Im1ldGhvZCI6IkNMSUVOVCIsIm5hbWUiOiJQcm9kdWN0X3VybCIsImZvcm1hdCI6LTEsInNjb3BlIjoiVklTSVQiLCJ0eXBlIjoiQ09VTlRfTElTVCJ9fX0="}};
})();if (window.kameleoonLightIframe){if (window.kameleoonExternalIFrameLoadedData) { window.kameleoonQueue = window.kameleoonQueue || [];window.kameleoonQueue.push({level: 'IMMEDIATE',command: function () {Kameleoon.Utils.runProtectedScript(window.kameleoonExternalIFrameLoadedData);}}); Kameleoon.Analyst.load();}}else{Kameleoon.Analyst.load();}}